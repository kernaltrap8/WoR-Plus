Unknown [1c0000000000000000001bb40000000000000000]SectionFloat current_crowd 1.00000SectionFloat average_crowd 1.00000SectionFloat total_crowd 0.00000SectionFloat max_crowd 0.00000SectionFloat crowd_scale 2.00000SectionFloat health_scale 2.00000SectionInteger crowd_debug_mode 0SectionInteger viewercam_nofail 0SectionFloat crowd_ped_camera_dist 3.50000SectionFloat crowd_ped_camera_height 1.07000SectionInteger crowd_ped_camera_fov 21SectionFloat crowd_rotate_param 25.0000SectionQBKey crowd_base_viewport_id crowd_base_viewportSectionQBKey crowd_base_viewport_texture tex\models\Real_Crowd\crowd_atlas0.ddsSectionQBKey crowd_config_xenon crowd_config_4x1_nojiggle_1024x512SectionQBKey crowd_config_ps3 crowd_config_4x1_nojiggle_1024x512SectionQBKey crowd_config_windx crowd_config_4x1_nojiggle_1024x512SectionInteger g_crowd_audio_anim_cues_enabled 0Script crowd_reset a13c592a [	${		StructInt loading_transition = 0		StructInt restarting = 0	}$		:i if (~$game_mode$ = $tutorial$)		:i return 	:i endif	:i $desired_health$ = %f(1.0)	:i $change$$current_crowd$ = %GLOBAL%$desired_health$	:i $change$$average_crowd$ = %GLOBAL%$desired_health$	:i $change$${StructFloat total_crowd = 0.00}$	:i $change$${StructFloat max_crowd = 0.00}$	:i $GetFirstPlayer$${StructQBKey out = first_player}$	:i if (%GLOBAL%$player$ = %GLOBAL%$first_player$)		:i $stopsoundevent$${StructQBString CurrentlyPlayingOneShotSoundEvent}$		:i if (~$current_playing_transition$ = $loading$)			:i if NOT ($GetNodeFlag$$ls_encore_post$)			:i endif		:i elseif (~$game_mode$ = $practice$)		:i elseif (%GLOBAL%$restarting$ = %i(1))			:i if (~$calibrate_lag_enabled$ = %i(0))				:i $spawnscriptnow$${					StructQBKey SFX_Backgrounds_New_Area					StructStruct params					{						StructHeader						{							StructQBString BG_SFX_Area = g_current_crowd_looping_bg_area_neutral							StructInt fadeintime = 10							StructQBKey fadeintype = linear							StructInt fadeouttime = 10							StructQBKey fadeouttype = linear						}					}				}$							:i else 				:i $spawnscriptnow$${					StructQBKey SFX_Backgrounds_New_Area					StructStruct params					{						StructHeader						{							StructQBKey BG_SFX_Area = frontend							StructInt fadeintime = 10							StructQBKey fadeintype = linear							StructInt fadeouttime = 10							StructQBKey fadeouttype = linear						}					}				}$							:i endif		:i elseif (~$end_credits$ = %i(1) OR 			:i $GetNodeFlag$$ls_encore_post$)			:i if $ScriptExists$${StructQBKey audio_crowd_play_loading_screen_swell}$				:i $KillSpawnedScript$${StructQBKey name = audio_crowd_play_loading_screen_swell}$				:i $setsoundbussparams$:s{$Crowd_Beds$ = :s{$vol$ = (~$Default_BussSet$->$Crowd_Beds$->$vol$):s}$time$ = %i(1):s}			:i endif		:i else 		:i endif	:i endif	:i $getplayerinfo$%GLOBAL%$player$$band$	:i $SetPlayerInfo$%GLOBAL%$player$$current_health$ = %GLOBAL%$desired_health$	:i $SetBandInfo$%GLOBAL%$band$$current_health$ = %GLOBAL%$desired_health$	:i $CrowdReset$	:i $Playlist_GetCurrentSong$	:i $get_song_prefix$$song$ = %GLOBAL%$current_song$	:i $FormatText$$checksumname$ = $scriptevents$%s("%s_scriptevents")$s$ = %GLOBAL%$song_prefix$$addtostringlookup$ = $true$	:i $change$${StructInt g_crowd_audio_anim_cues_enabled = 1}$	:i if $SongGlobalExists$$name$ = %GLOBAL%$scriptevents$		:i if $CheckScriptEvents$$name$ = %GLOBAL%$scriptevents$$event$ = $change_crowd_state$			:i $KillSpawnedScript$${StructQBKey name = Crowd_PlayAnim_Spawned}$			:i $change$${StructInt g_crowd_audio_anim_cues_enabled = 0}$		:i endif	:i endif	:i endfunction]Script forcescore e263aa07 [	:i switch ~$debug_forcescore$		:i case $poor$			:i $health$ = (~$health_poor_medium$ / %i(2))			:i endcase		case $medium$			:i $health$ = ((~$health_poor_medium$ + ~$health_medium_good$) / %i(2))			:i endcase		case $good$			:i $health$ = ((~$health_medium_good$ + ~$health_scale$) / %i(2))			:i endcase		default 			:i $health$ = (~$health_poor_medium$ / %i(2))	:i end_switch	:i $SetPlayerInfo$%GLOBAL%$player$$current_health$ = %GLOBAL%$health$	:i $change$$current_crowd$ = %GLOBAL%$health$	:i endfunction]SectionInteger base_resolve_priority 7Script create_crowd_models fe38ccd4 [	:i if (~$disable_crowd$ = %i(1))		:i return 	:i endif	:i $GetPakManCurrentName$${StructQBKey map = zones}$	:i $FormatText$$checksumname$ = $crowd_models$%s("%s_2D_crowd_models")$s$ = %GLOBAL%$pakname$	:i if NOT $globalexists$$name$ = %GLOBAL%$crowd_models$		:i return 	:i endif	:i $MemPushContext$${StructQBKey heap_crowd}$	:i $change$$crowd_model_array$ = ~%GLOBAL%$crowd_models$	:i $GetPlatform$	:i if (%GLOBAL%$platform$ = $xenon$)		:i $crowd_config$ = ~$crowd_config_xenon$	:i elseif (%GLOBAL%$platform$ = $windx$)		:i $crowd_config$ = ~$crowd_config_windx$	:i elseif (%GLOBAL%$platform$ = $ps3$)		:i $crowd_config$ = ~$crowd_config_ps3$	:i else 		:i $scriptassert$${StructQBStringQs 0x34a7da06}$	:i endif	:i $base_style$ = (~%GLOBAL%$crowd_config$->$base_viewport_params$->$style$)	:i $CreateViewport$:s{		:i $priority$ = (~$base_resolve_priority$)		:i $id$ = (~$crowd_base_viewport_id$)		:i $texture$ = (~$crowd_base_viewport_texture$)		:i $style$ = %GLOBAL%$base_style$	:i :s}	:i $SetViewportProperties$:s{		:i $viewport$ = (~$crowd_base_viewport_id$)		:i $no_resolve_colorbuffer$ = (~%GLOBAL%$crowd_config$->$base_viewport_params$->$no_resolve_color_buffer$)		:i $resolve_invalidated$ = (~%GLOBAL%$crowd_config$->$base_viewport_params$->$resolve_invalidated$)		:i $no_resolve_depthstencilbuffer$ = $true$		:i $clear_colorbuffer$ = $false$		:i $clear_depthstencilbuffer$ = $false$		:i $crowd_impostor$ = $true$	:i :s}	:i $GetArraySize$~%GLOBAL%$crowd_models$	:i $GetArraySize$$param$ = $config_num_viewports$(~%GLOBAL%$crowd_config$->$ped_viewport_params$)	:i if (%GLOBAL%$array_size$ > %GLOBAL%$config_num_viewports$)		:i $scriptassert$%s("Crowd models array has %a, but there are only %b viewports in the viewport configuration")$a$ = %GLOBAL%$array_size$$b$ = %GLOBAL%$config_num_viewports$	:i endif	:i $crowd_bb_mesh_idx$ = %i(0)	:i while 	:i $bb_base_sector_name$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$crowd_bb_mesh_idx$:a}->$bb_mesh_id$)	:i $AddCrowdToVisibilityTest$$crowdnode$ = %GLOBAL%$bb_base_sector_name$	:i %GLOBAL%$crowd_bb_mesh_idx$ = (%GLOBAL%$crowd_bb_mesh_idx$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i $array_count$ = %i(0)	:i while 	:i $Pos$ = (%vec3(-500.0,-200.0,0.0) + %vec3(0.0,-100.0,0.0) * %GLOBAL%$array_count$)	:i $viewport$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)	:i $camera$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$camera$)	:i $bb_sector_name$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$bb_mesh_id$)	:i if NOT $StructureContains$$structure$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a})$remap_only$		:i if $IsPS3$			:i $MemPushContext$${StructQBKey bottomupheap}$		:i endif		:i $CreateFromStructure$:s{			:i $Pos$ = %GLOBAL%$Pos$			:i $Quat$ = %vec3(0.0,1.0,0.0)			:i $class$ = $gameobject$			:i $type$ = $Ghost$			:i $createdatstart$			:i (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a})			:i $suspenddistance$ = %i(0)			:i $lod_dist1$ = %i(400)			:i $lod_dist2$ = %i(401)			:i $profile$ = ~$Profile_Ped_Crowd_Obj$			:i $lightgroup$ = $crowd$			:i $interleave_animations$			:i $object_type$ = $crowd$			:i $profilecolor$ = %i(49344)			:i $profilebudget$ = %i(200)			:i $use_jq$			:i $viewports$ = :a{$all$:a}		:i :s}		:i $model_id$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$name$)		:i $extra_model$ = %s("Real_Crowd\Crowd_HandL_Rock.skin")		:i %GLOBAL%$model_id$.$addgeom$$lhand_rock$$Model$ = %GLOBAL%$extra_model$$lightgroup$ = $crowd$		:i $extra_model$ = %s("Real_Crowd\Crowd_HandL_Clap.skin")		:i %GLOBAL%$model_id$.$addgeom$$lhand_clap$$Model$ = %GLOBAL%$extra_model$$lightgroup$ = $crowd$		:i $extra_model$ = %s("Real_Crowd\Crowd_HandL_Fist.skin")		:i %GLOBAL%$model_id$.$addgeom$$lhand_fist$$Model$ = %GLOBAL%$extra_model$$lightgroup$ = $crowd$		:i $extra_model$ = %s("Real_Crowd\Crowd_HandR_Rock.skin")		:i %GLOBAL%$model_id$.$addgeom$$rhand_rock$$Model$ = %GLOBAL%$extra_model$$lightgroup$ = $crowd$		:i $extra_model$ = %s("Real_Crowd\Crowd_HandR_Clap.skin")		:i %GLOBAL%$model_id$.$addgeom$$rhand_clap$$Model$ = %GLOBAL%$extra_model$$lightgroup$ = $crowd$		:i $extra_model$ = %s("Real_Crowd\Crowd_HandR_Fist.skin")		:i %GLOBAL%$model_id$.$addgeom$$rhand_fist$$Model$ = %GLOBAL%$extra_model$$lightgroup$ = $crowd$		:i %GLOBAL%$model_id$.$switchoffatomic$$lhand_rock$		:i %GLOBAL%$model_id$.$switchoffatomic$$lhand_fist$		:i %GLOBAL%$model_id$.$switchonatomic$$lhand_clap$		:i %GLOBAL%$model_id$.$switchoffatomic$$rhand_rock$		:i %GLOBAL%$model_id$.$switchoffatomic$$rhand_fist$		:i %GLOBAL%$model_id$.$switchonatomic$$rhand_clap$		:i %GLOBAL%$model_id$.$obj_setnoquadcull$		:i $roty$ = %i(0)		:i if $StructureContains$$structure$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a})$roty$			:i $roty$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$roty$)		:i endif		:i if (%GLOBAL%$roty$ = %i(0))			:i $apply_correction$ = %i(1)		:i else 			:i $apply_correction$ = %i(0)			:i (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$name$).$obj_setorientation$$y$ = (%i(180) + %GLOBAL%$roty$)		:i endif		:i if NOT (%GLOBAL%$bb_sector_name$ = %i(0))			:i $ToggleIntraMeshSorting$$on$ = %i(1)$ObjID$ = %GLOBAL%$bb_sector_name$		:i endif		:i if $IsPS3$			:i $MemPopContext$${StructQBKey bottomupheap}$		:i endif		:i $style$ = $[00000000]$		:i $use_resource$ = $[00000000]$		:i if $StructureContains$$structure$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a})$ResourceViewport$			:i %GLOBAL%$use_resource$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$ResourceViewport$)		:i endif		:i $printstruct$ isNull 		:i $CreateViewport$:s{			:i $priority$ = (~$base_resolve_priority$ + %i(1) + %GLOBAL%$array_count$)			:i $id$ = %GLOBAL%$viewport$			:i $texture$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$texture$)			:i $style$ = (~%GLOBAL%$crowd_config$->$ped_viewport_params$:a{%GLOBAL%$array_count$:a}->$style$)			:i $use_resource$ = %GLOBAL%$use_resource$		:i :s}		:i $CreateCompositeObjectInstance$:s{			:i $priority$ = ~$coim_priority_permanent$			:i $heap$ = $generic$			:i $Components$ = :a{				:i :s{$Component$ = $camera$:s}			:i :a}			:i $params$ = :s{				:i $name$ = %GLOBAL%$camera$				:i $viewport$ = %GLOBAL%$viewport$				:i $object_type$ = $crowd$				:i $profilecolor$ = %i(12632064)				:i $profilebudget$ = %i(10)				:i $use_jq$				:i $far_clip$ = %i(20)			:i :s}		:i :s}		:i $jiggle$ = (~%GLOBAL%$crowd_config$->$jiggle$)		:i if (%GLOBAL%$jiggle$ !== %i(0))			:i $jiggle_index$ = (~%GLOBAL%$crowd_config$->$index$:a{%GLOBAL%$array_count$:a})		:i else 			:i $jiggle_index$ = %i(0)		:i endif		:i $no_resolve_colorbuffer$ = (~%GLOBAL%$crowd_config$->$ped_viewport_params$:a{%GLOBAL%$array_count$:a}->$no_resolve_color_buffer$)		:i $SetActiveCamera$$viewport$ = %GLOBAL%$viewport$$id$ = %GLOBAL%$camera$		:i %GLOBAL%$camera$.$sethfov$$hfov$ = ~$crowd_ped_camera_fov$		:i $SetViewportProperties$$viewport$ = %GLOBAL%$viewport$$no_resolve_colorbuffer$ = %GLOBAL%$no_resolve_colorbuffer$$no_resolve_depthstencilbuffer$ = $true$$crowd_impostor$ = $true$$jiggle_rendering$ = %GLOBAL%$jiggle$$jiggle_count$ = %GLOBAL%$jiggle_index$		:i $AddCrowdModelCam$$camera$ = %GLOBAL%$camera$$Pos$ = %GLOBAL%$Pos$$viewport$ = %GLOBAL%$viewport$$apply_correction$ = %GLOBAL%$apply_correction$	:i endif	:i $setsearchallassetcontexts$	:i $CreateViewportTextureOverride$:s{		:i $id$ = %GLOBAL%$viewport$		:i $viewportid$ = %GLOBAL%$viewport$		:i $texture$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$textureasset$)		:i $texdict$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$texdict$)	:i :s}	:i $setsearchallassetcontexts$${StructQBKey Off}$	:i %GLOBAL%$array_count$ = (%GLOBAL%$array_count$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i $MemPopContext$${StructQBKey heap_crowd}$	:i $SetSpecificRenderTargetHeap$	:i endfunction]Script update_crowd_model_cam 0x0c9f5b99 [	:i $crowd_scaler$ = %i(25)	:i while 	:i $GetViewportCameraOrient$${StructQBKey viewport = bg_viewport}$	:i $GetVectorComponents$%GLOBAL%$at$	:i $Angle$ = (%GLOBAL%$x$ * %GLOBAL%$crowd_scaler$)	:i $RotateVector$$vector$ = %GLOBAL%$at$$ry$ = %GLOBAL%$Angle$	:i $at$ = %GLOBAL%$result_vector$	:i $RotateVector$$vector$ = %GLOBAL%$left$$ry$ = %GLOBAL%$Angle$	:i $left$ = %GLOBAL%$result_vector$	:i $RotateVector$$vector$ = %GLOBAL%$up$$ry$ = %GLOBAL%$Angle$	:i $up$ = %GLOBAL%$result_vector$	:i $posdir$ = (%GLOBAL%$model_pos$ + %vec3(0.0,1.0,0.0) + (%GLOBAL%$at$ * %f(3.5)))	:i %GLOBAL%$camera$.$obj_setposition$$position$ = %GLOBAL%$posdir$	:i %GLOBAL%$camera$.$obj_setorientation$$dir$ = %GLOBAL%$at$$only$$handles$$upright$$cameras$	:i $SetViewportCameraOrient$$viewport$ = %GLOBAL%$viewport$$at$ = %GLOBAL%$at$$left$ = %GLOBAL%$left$$up$ = %GLOBAL%$up$	:i %GLOBAL%$camera$.$UnPause$	:i $wait$${		StructInt 1		StructQBKey gameframe	}$		:i loop_to 	:i endfunction]SectionInteger g_old_visibility_mask 0Script hide_crowd_models 0x5a7445ae [	${StructQBKey active = true}$	:i if $GotParam$${StructQBKey from_scriptevent}$		:i $wait_for_next_odd_frame$		:i $wait$${			StructInt 5			StructQBKey gameframes		}$			:i endif	:i $crowd_models$ = ~$crowd_model_array$	:i if (%GLOBAL%$crowd_models$ !== $None$)		:i $GetArraySize$%GLOBAL%$crowd_models$		:i $array_count$ = %i(0)		:i while 		:i $viewport$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)		:i $ObjID$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$name$)		:i if $ObjectExists$$id$ = %GLOBAL%$ObjID$			:i if NOT $StructureContains$$structure$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a})$remap_only$				:i if (%GLOBAL%$active$ = $true$)					:i %GLOBAL%$ObjID$.$hide$				:i else 					:i %GLOBAL%$ObjID$.$unhide$				:i endif			:i endif		:i endif		:i %GLOBAL%$array_count$ = (%GLOBAL%$array_count$ + %i(1))		:i loop_to %GLOBAL%$array_size$	:i endif	:i $GetRenderBatchSystemVisibility$${StructQBKey name = Crowd3D}$	:i if (%GLOBAL%$active$ = $true$)		:i if (%GLOBAL%$visibility_mask$ !== %i(1))			:i $change$$g_old_visibility_mask$ = %GLOBAL%$visibility_mask$			:i $SetRenderBatchSystemVisibility$${				StructQBKey name = Crowd3D				StructInt visibility_mask = 1			}$					:i endif	:i else 		:i if (%GLOBAL%$visibility_mask$ = %i(1))			:i if (~$g_old_visibility_mask$ = %i(1))				:i $SetRenderBatchSystemVisibility$${					StructQBKey name = Crowd3D					StructInt visibility_mask = 4				}$							:i else 				:i $SetRenderBatchSystemVisibility$$name$ = $Crowd3D$$visibility_mask$ = (~$g_old_visibility_mask$)				:i $change$${StructInt g_old_visibility_mask = 1}$			:i endif		:i endif	:i endif	:i endfunction]Script destroy_crowd_models cff465a9 [	:i $ClearCrowdModelCams$	:i $ClearCrowdsFromVisibilityTest$	:i $DestroyCrowd3D$	:i $crowd_models$ = ~$crowd_model_array$	:i if (%GLOBAL%$crowd_models$ = $None$)		:i return 	:i endif	:i $GetArraySize$%GLOBAL%$crowd_models$	:i $array_count$ = %i(0)	:i while 	:i if NOT $StructureContains$$structure$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a})$remap_only$		:i $KillSpawnedScript$${StructQBKey name = update_crowd_model_cam}$		:i if $CompositeObjectExists$$name$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$camera$)			:i (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$camera$).$Die$		:i endif		:i if $ScreenElementExists$$id$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)			:i $setsearchallassetcontexts$			:i $DestroyViewportTextureOverride$$id$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)			:i $setsearchallassetcontexts$${StructQBKey Off}$			:i $DestroyScreenElement$$id$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)		:i endif		:i $setsearchallassetcontexts$		:i $DestroyViewportTextureOverride$$id$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)		:i $setsearchallassetcontexts$${StructQBKey Off}$		:i if $ViewportExists$$id$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)			:i $DestroyViewport$$id$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$id$)		:i endif		:i if $CompositeObjectExists$$name$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$name$)			:i (%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$name$).$Die$		:i endif	:i endif	:i %GLOBAL%$array_count$ = (%GLOBAL%$array_count$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i $DestroyViewport$$id$ = (~$crowd_base_viewport_id$)	:i $change$${StructQBKey crowd_model_array = None}$	:i endfunction]Script set_crowd_hand 0x179de559 [	${		StructQBKey Hand = left		StructQBKey type = clap	}$		:i $obj_getid$	:i $name$ = %GLOBAL%$ObjID$	:i if (%GLOBAL%$Hand$ = $left$)		:i switch (%GLOBAL%$type$)			:i case $rock$				:i $part$ = $lhand_rock$				:i endcase			case $clap$				:i $part$ = $lhand_clap$				:i endcase			case $fist$				:i $part$ = $lhand_fist$		:i end_switch		:i %GLOBAL%$name$.$switchoffatomic$$lhand_rock$		:i %GLOBAL%$name$.$switchoffatomic$$lhand_clap$		:i %GLOBAL%$name$.$switchoffatomic$$lhand_fist$		:i %GLOBAL%$name$.$switchonatomic$%GLOBAL%$part$	:i else 		:i switch (%GLOBAL%$type$)			:i case $rock$				:i $part$ = $rhand_rock$				:i endcase			case $clap$				:i $part$ = $rhand_clap$				:i endcase			case $fist$				:i $part$ = $rhand_fist$		:i end_switch		:i %GLOBAL%$name$.$switchoffatomic$$rhand_rock$		:i %GLOBAL%$name$.$switchoffatomic$$rhand_clap$		:i %GLOBAL%$name$.$switchoffatomic$$rhand_fist$		:i %GLOBAL%$name$.$switchonatomic$%GLOBAL%$part$	:i endif	:i endfunction]Script Crowd_AllPlayAnim 0x1d57a96d [	${StructQBKey playonce = false}$	:i if (~$g_crowd_audio_anim_cues_enabled$ = %i(0))		:i return 	:i endif	:i if $CompositeObjectExists$${StructQBKey Crowd3D_Model1}$		:i $name$ = $Crowd3D_Model1$	:i else 		:i if $CompositeObjectExists$${StructQBKey crowd1}$			:i $name$ = $crowd1$		:i else 			:i return 		:i endif	:i endif	:i %GLOBAL%$name$.$obj_killspawnedscript$$name$ = $Crowd_PlayAnim_Spawned$	:i %GLOBAL%$name$.$obj_spawnscriptnow$$Crowd_PlayAnim_Spawned$$params$ = :s{$anim$ = %GLOBAL%$anim$$playonce$ = %GLOBAL%$playonce$:s}	:i endfunction]Script Crowd_PlayAnim_Spawned 0x9321aa2c [	${StructQBKey playonce = false}$	:i $enable_swell$ = %i(1)	:i switch %GLOBAL%$anim$		:i case $SwellSH$			:i $peak_time$ = %f(2.5)			:i $fade_time$ = %f(6.5)			:i endcase		case $SwellMD$			:i $peak_time$ = %f(4.0)			:i $fade_time$ = %f(8.0)			:i endcase		case $SwellLG$			:i $peak_time$ = %f(0.5)			:i $fade_time$ = %f(7.0)			:i endcase		case $idle$			:i $enable_swell$ = %i(0)			:i $change_crowd_state$${StructQBKey new_state = Mellow}$			:i $wait$${				StructInt 5				StructQBKey seconds			}$				:i end_switch	:i if (%GLOBAL%$enable_swell$ = %i(1))		:i $hero_get_skill_level_cfunc$		:i switch %GLOBAL%$skill$			:i case $bad$				:i $change_crowd_state$${StructQBKey new_state = Mellow}$				:i $wait$(%GLOBAL%$peak_time$ / %i(2))$seconds$				:i $change_crowd_state$${StructQBKey new_state = Interested}$				:i $wait$(%GLOBAL%$peak_time$ / %i(2))$seconds$				:i $wait$(%GLOBAL%$fade_time$ / %i(2))$seconds$				:i $change_crowd_state$${StructQBKey new_state = Mellow}$				:i $wait$(%GLOBAL%$fade_time$ / %i(2))$seconds$				:i endcase			case $normal$				:i $change_crowd_state$${StructQBKey new_state = Interested}$				:i $wait$(%GLOBAL%$peak_time$ / %i(2))$seconds$				:i $change_crowd_state$${StructQBKey new_state = stoked}$				:i $wait$(%GLOBAL%$peak_time$ / %i(2))$seconds$				:i $wait$(%GLOBAL%$fade_time$ / %i(2))$seconds$				:i $change_crowd_state$${StructQBKey new_state = Interested}$				:i $wait$(%GLOBAL%$fade_time$ / %i(2))$seconds$				:i endcase			case $good$				:i $change_crowd_state$${StructQBKey new_state = stoked}$				:i $wait$(%GLOBAL%$peak_time$ / %i(2))$seconds$				:i $change_crowd_state$${StructQBKey new_state = insane}$				:i $wait$(%GLOBAL%$peak_time$ / %i(2))$seconds$				:i $wait$(%GLOBAL%$fade_time$ / %i(2))$seconds$				:i $change_crowd_state$${StructQBKey new_state = stoked}$				:i $wait$(%GLOBAL%$fade_time$ / %i(2))$seconds$		:i end_switch	:i endif	:i while 	:i $hero_get_skill_level_cfunc$	:i switch %GLOBAL%$skill$		:i case $bad$			:i $change_crowd_state$${StructQBKey new_state = Mellow}$			:i endcase		case $normal$			:i $change_crowd_state$${StructQBKey new_state = Interested}$			:i endcase		case $good$			:i $change_crowd_state$${StructQBKey new_state = stoked}$	:i end_switch	:i $wait$${		StructInt 4		StructQBKey seconds	}$		:i loop_to 	:i endfunction]Script Crowd_StageDiver_Hide 0x37651481 [	${StructInt index = 1}$	:i $GetPakManCurrentName$${StructQBKey map = zones}$	:i $FormatText$$checksumname$ = $stagediver$%s("%s_TRG_Ped_StageDive0%a")$s$ = %GLOBAL%$pakname$$a$ = %GLOBAL%$index$	:i if $CompositeObjectExists$$name$ = %GLOBAL%$stagediver$		:i %GLOBAL%$stagediver$.$hide$	:i endif	:i endfunction]Script Crowd_StageDiver_Jump cadcabf5 [	${StructInt index = 1}$	:i $GetPakManCurrentName$${StructQBKey map = zones}$	:i $FormatText$$checksumname$ = $stagediver$%s("%s_TRG_Ped_StageDive0%a")$s$ = %GLOBAL%$pakname$$a$ = %GLOBAL%$index$	:i if $CompositeObjectExists$$name$ = %GLOBAL%$stagediver$		:i %GLOBAL%$stagediver$.$unhide$		:i $GetPakManCurrent$${StructQBKey map = zones}$		:i if $StructureContains$$structure$ = (~$stagediver_anims$)$name$ = %GLOBAL%$pak$			:i $anims$ = (~$stagediver_anims$->%GLOBAL%$pak$)		:i else 			:i $anims$ = (~$stagediver_anims$->$default$)		:i endif		:i $GetArraySize$%GLOBAL%$anims$		:i $getrandomvalue$$name$ = $anim_index$$integer$$a$ = %i(0)$b$ = (%GLOBAL%$array_size$ - %i(1))		:i $anim_name$ = (%GLOBAL%$anims$:a{%GLOBAL%$anim_index$:a})		:i $printf$$channel$ = $crowd$^[b75db1d6]^$a$ = %GLOBAL%$anim_name$		:i %GLOBAL%$stagediver$.$GameObj_PlayAnim$$anim$ = %GLOBAL%$anim_name$		:i %GLOBAL%$stagediver$.$GameObj_WaitAnimFinished$		:i %GLOBAL%$stagediver$.$hide$	:i else 		:i $printf$${			StructQBKey channel = crowd			StructQBStringQs 0x7797b93e		}$			:i endif	:i endfunction]SectionStruct crowd3D_static_tree{	StructHeader	{		StructQBKey id = Body		StructQBKey type = degenerateblend	}}Script CreateCrowd3D a2087b74 [	:i if (~$disable_crowd$ = %i(1))		:i return 	:i endif	:i $printf$${StructQBStringQs 0x04ac502f}$	:i $FormatText$$checksumname$ = $crowd_models$%s("%s_3D_crowd_models")$s$ = (~$GHZones$->%GLOBAL%$zone_name$->$name$)	:i if NOT $globalexists$$name$ = %GLOBAL%$crowd_models$		:i $printf$${StructQBStringQs a03e6592}$		:i return 	:i endif	:i $MemPushContext$${StructQBKey heap_crowd}$	:i if (%GLOBAL%$zone_name$ = $Z_Modular$)		:i $vis_mask$ = (~$g_viewport_visibility$->$tem$)		:i $vis_viewports$ = :a{$tem$:a}	:i else 		:i $vis_mask$ = (~$g_viewport_visibility$->$ven$)		:i $vis_viewports$ = :a{$ven$:a}	:i endif	:i $CreateRenderBatchSystem$$name$ = %s("Crowd3D")$viewport$ = $bg_viewport$$visibility_mask$ = %GLOBAL%$vis_mask$$model_count$ = %i(8)$instance_count$ = %i(512)$min$ = %f(0.8999999)$max$ = %f(1.0)	:i $change$$crowd_3D_model_array$ = ~%GLOBAL%$crowd_models$	:i $GetArraySize$~%GLOBAL%$crowd_models$	:i $array_count$ = %i(0)	:i while 	:i $Pos$ = (%vec3(0.0,0.0,0.0) + %vec3(0.0,-5.0,0.0) * %GLOBAL%$array_count$)	:i $setsearchallassetcontexts$	:i if NOT $StructureContains$$structure$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a})$remap_only$		:i if $IsPS3$		:i endif		:i $FormatText$$textname$ = $array_count_string$%s("%i")$i$ = (%GLOBAL%$array_count$ + %i(1))		:i $AppendSuffixToChecksum$$base$ = $Crowd3D_Model$$suffixstring$ = %GLOBAL%$array_count_string$		:i %GLOBAL%$model_name$ = %GLOBAL%$appended_id$		:i $CreateFromDesc$:s{			:i $name$ = %GLOBAL%$model_name$			:i $Pos$ = %GLOBAL%$Pos$			:i $Quat$ = %vec3(0.0,1.0,0.0)			:i $class$ = $gameobject$			:i $type$ = $Ghost$			:i $createdatstart$			:i $Model$ = (~%GLOBAL%$crowd_models$:a{%GLOBAL%$array_count$:a}->$Model$)			:i $suspenddistance$ = %i(0)			:i $lod_dist1$ = %i(400)			:i $lod_dist2$ = %i(401)			:i ~$Profile_Ped_Crowd_Obj$			:i $composite_type$ = $LevelInstanceObject$			:i $lightgroup$ = :a{$CrowdCards$$Crowd3D$:a}			:i $interleave_animations$			:i $profilecolor$ = %i(49344)			:i $profilebudget$ = %i(200)			:i $use_jq$			:i $viewports$ = %GLOBAL%$vis_viewports$		:i :s}		:i %GLOBAL%$anim_index$ = %i(1)		:i while 		:i $FormatText$$textname$ = $anim_suffix_string$%s("_anim%i")$i$ = %GLOBAL%$anim_index$		:i $AppendSuffixToChecksum$$base$ = %GLOBAL%$model_name$$suffixstring$ = %GLOBAL%$anim_suffix_string$		:i %GLOBAL%$anim_name$ = %GLOBAL%$appended_id$		:i $CreateFromDesc$:s{			:i $name$ = %GLOBAL%$anim_name$			:i $Pos$ = %GLOBAL%$Pos$			:i $Quat$ = %vec3(0.0,1.0,0.0)			:i $class$ = $gameobject$			:i $type$ = $Ghost$			:i $createdatstart$			:i $suspenddistance$ = %i(0)			:i $lod_dist1$ = %i(400)			:i $lod_dist2$ = %i(401)			:i ~$Profile_Ped_Crowd_Obj$			:i $composite_type$ = $LevelInstanceAnimation$			:i $interleave_animations$			:i $active_value_set$ = $preview$			:i $active_value_source_list$ = ~$default_active_values$			:i $profilecolor$ = %i(49344)			:i $profilebudget$ = %i(200)			:i $use_jq$			:i $viewports$ = %GLOBAL%$vis_viewports$		:i :s}		:i %GLOBAL%$anim_name$.$anim_inittree$$tree$ = ~$crowd3D_static_tree$$nodeiddeclaration$ = :a{$Body$$bodytimer$:a}		:i %GLOBAL%$anim_index$ = (%GLOBAL%$anim_index$ + %i(1))		:i loop_to %i(4)		:i %GLOBAL%$model_name$.$hide$		:i if $IsPS3$		:i endif	:i endif	:i %GLOBAL%$array_count$ = (%GLOBAL%$array_count$ + %i(1))	:i $setsearchallassetcontexts$${StructQBKey Off}$	:i loop_to %GLOBAL%$array_size$	:i $MemPopContext$${StructQBKey heap_crowd}$	:i $printf$${StructQBStringQs c40a8d79}$	:i endfunction]Script DestroyCrowd3D 0x2f227b9c [	:i %GLOBAL%$crowd_models$ = :a{		:i $Crowd3D_Model1$		:i $crowd3d_model1_anim1$		:i $crowd3d_model1_anim2$		:i $crowd3d_model1_anim3$		:i $crowd3d_model1_anim4$		:i $Crowd3D_Model2$		:i $crowd3d_model2_anim1$		:i $crowd3d_model2_anim2$		:i $crowd3d_model2_anim3$		:i $crowd3d_model2_anim4$		:i $Crowd3D_Model3$		:i $crowd3d_model3_anim1$		:i $crowd3d_model3_anim2$		:i $crowd3d_model3_anim3$		:i $crowd3d_model3_anim4$		:i $Crowd3D_Model4$		:i $crowd3d_model4_anim1$		:i $crowd3d_model4_anim2$		:i $crowd3d_model4_anim3$		:i $crowd3d_model4_anim4$	:i :a}	:i $GetArraySize$%GLOBAL%$crowd_models$	:i $i$ = %i(0)	:i while 	:i %GLOBAL%$name$ = (%GLOBAL%$crowd_models$:a{%GLOBAL%$i$:a})	:i if $CompositeObjectExists$$name$ = %GLOBAL%$name$		:i %GLOBAL%$name$.$Die$	:i endif	:i %GLOBAL%$i$ = (%GLOBAL%$i$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i $DumpCompositeObjects$	:i $DestroyRenderBatchSystem$${StructQBKey name = Crowd3D}$	:i $change$${StructQBKey crowd_3D_model_array = None}$	:i endfunction]