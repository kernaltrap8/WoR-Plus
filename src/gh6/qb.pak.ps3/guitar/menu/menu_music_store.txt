Unknown [1c00000000000000000012dc0000000000000000]SectionInteger music_store_attempted_purchase 0Script music_store_preload_album_covers 0x9ccb2b9a [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				list			]		}		StructQBKey all	}$		:i $calculate_preview_image_limit$	:i $GetArraySize$%GLOBAL%$list$	:i if (%GLOBAL%$array_size$ > %i(0))		:i if (%GLOBAL%$array_size$ > %GLOBAL%$limit$)			:i $array_size$ = %GLOBAL%$limit$		:i endif		:i $array$ = :a{:a}		:i $i$ = %i(0)		:i while 		:i if $StructureContains$$structure$ = (%GLOBAL%$list$:a{%GLOBAL%$i$:a})$song_preview_asset_name$			:i $AddArrayElement$$array$ = %GLOBAL%$array$$element$ = ((%GLOBAL%$list$:a{%GLOBAL%$i$:a})->$song_preview_asset_name$)		:i endif		:i $i$ = (%GLOBAL%$i$ + %i(1))		:i loop_to %GLOBAL%$array_size$		:i $PreviewAssetCache$$func$ = $request_image$$images$ = %GLOBAL%$array$	:i endif	:i endfunction]Script music_store_change_album_cover bbe40fdc [	${StructQBKey desc = SongList_detail}$	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				texture_name			]		}		StructQBKey all	}$		:i if NOT $ScreenElementExists$$id$ = %GLOBAL%$desc$		:i return 	:i endif	:i if $ScriptIsRunning$${StructQBKey music_store_replace_album_cover_when_loaded}$		:i $KillSpawnedScript$${StructQBKey name = music_store_replace_album_cover_when_loaded}$	:i endif	:i $FormatText$$checksumname$ = $texture_id$%s("%s_image_dl")$s$ = %GLOBAL%$texture_name$$addtostringlookup$ = $true$	:i $FormatText$$checksumname$ = $texture$%s("download/preview/%s_image_dl.img")$s$ = %GLOBAL%$texture_name$$addtostringlookup$ = $true$	:i $music_store_get_current_album_texture$$desc$ = %GLOBAL%$desc$	:i if (%GLOBAL%$texture_id$ !== %GLOBAL%$current_album_texture$)		:i $PreviewAssetCache$$func$ = $release_image$$name$ = %GLOBAL%$current_album_texture$	:i endif	:i %GLOBAL%$desc$.$se_setprops$$songlist_detail_album_sprite_texture$ = $mainmenu_logo_lrg$	:i %GLOBAL%$desc$.$obj_spawnscriptnow$$music_store_replace_album_cover_when_loaded$$params$ = :s{$texture_id$ = %GLOBAL%$texture_id$$texture$ = %GLOBAL%$texture$$desc$ = %GLOBAL%$desc$:s}	:i endfunction]Script music_store_replace_album_cover_when_loaded 0x416fccd0 [	${StructQBKey desc = SongList_detail}$	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				texture_id				texture			]		}		StructQBKey all	}$		:i if NOT $ScreenElementExists$$id$ = %GLOBAL%$desc$		:i return 	:i endif	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = kill_oldest	}$		:i $music_store_turn_on_loading$$desc$ = %GLOBAL%$desc$	:i while 	:i if $PreviewAssetCache$$func$ = $is_image_loaded$$name$ = %GLOBAL%$texture_id$		:i $printf$${StructQBStringQs 0x37f47d5b}$		:i $music_store_turn_off_loading$$desc$ = %GLOBAL%$desc$		:i $PreviewAssetCache$$func$ = $lock_image$$name$ = %GLOBAL%$texture_id$		:i $music_store_set_current_album_texutre$$texture_id$ = %GLOBAL%$texture_id$$desc$ = %GLOBAL%$desc$		:i if $ScreenElementExists$$id$ = %GLOBAL%$desc$			:i %GLOBAL%$desc$.$se_setprops$$songlist_detail_album_sprite_texture$ = %GLOBAL%$texture$		:i endif		:i return 	:i endif	:i $wait$${		StructInt 5		StructQBKey gameframes	}$		:i loop_to %i(500)	:i $music_store_turn_off_loading$$desc$ = %GLOBAL%$desc$	:i $printf$${StructQBStringQs 0x8ed15842}$	:i endfunction]Script music_store_get_current_album_texture 0x781d0488 [	:i if $ScreenElementExists$$id$ = %GLOBAL%$desc$		:i $current_album_texture_id$ = $mainmenu_logo_lrg$		:i %GLOBAL%$desc$.$getsingletag$$current_album_texture_id$		:i return $current_album_texture$ = %GLOBAL%$current_album_texture_id$	:i else 		:i $scriptassert$${StructString 0x00000000 = "music_store_get_current_album_texture was called while ScreenElement did not exist"}$	:i endif	:i endfunction]Script music_store_set_current_album_texutre 0x8fde9817 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				texture_id			]		}	}$		:i if $ScreenElementExists$$id$ = %GLOBAL%$desc$		:i %GLOBAL%$desc$.$settags$$current_album_texture_id$ = %GLOBAL%$texture_id$	:i else 		:i $scriptassert$${StructString 0x00000000 = "music_store_set_current_album_texutre was called while ScreenElement did not exist"}$	:i endif	:i endfunction]Script music_store_preload_preview_music 0x5f5ff780 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				list			]		}		StructQBKey all	}$		:i $GetArraySize$%GLOBAL%$list$	:i if (%GLOBAL%$array_size$ > %i(0))		:i $array$ = :a{:a}		:i $i$ = %i(0)		:i while 		:i if $StructureContains$$structure$ = (%GLOBAL%$list$:a{%GLOBAL%$i$:a})$song_preview_asset_name$			:i $AddArrayElement$$array$ = %GLOBAL%$array$$element$ = ((%GLOBAL%$list$:a{%GLOBAL%$i$:a})->$song_preview_asset_name$)		:i endif		:i $i$ = (%GLOBAL%$i$ + %i(1))		:i loop_to %GLOBAL%$array_size$		:i $PreviewAssetCache$$func$ = $request_sound$$music$ = %GLOBAL%$array$	:i endif	:i endfunction]Script music_store_request_preview_music e70fd10c [	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i if $ScriptIsRunning$${StructQBKey music_store_monitor_loop_sound}$		:i return 	:i endif	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				music_name			]		}		StructQBKey all	}$		:i if $ScreenElementExists$${StructQBKey id = songlist_component}$		:i $songlist_component$.$getsingletag$${StructQBKey music_id}$		:i if $GotParam$${StructQBKey music_id}$			:i if $IsSoundPlayingByID$%GLOBAL%$music_id$				:i return 			:i endif		:i endif	:i endif	:i if $IsPS3$		:i $plat$ = %s("ps3")	:i else 		:i $plat$ = %s("xen")	:i endif	:i $music_store_turn_on_loading$${StructQBKey desc = songlist_options}$	:i while 	:i $FormatText$$checksumname$ = $music_short_name$%s("%s_music_dl")$s$ = %GLOBAL%$music_name$$addtostringlookup$ = $true$	:i $FormatText$$checksumname$ = $music$%s("download/preview/%p/%s_music_dl.fsb")$s$ = %GLOBAL%$music_name$$p$ = %GLOBAL%$plat$$addtostringlookup$ = $true$	:i if $PreviewAssetCache$$func$ = $is_sound_loaded$$name$ = %GLOBAL%$music_short_name$		:i $printf$${StructQBStringQs c002938d}$		:i $music_store_turn_off_loading$${StructQBKey desc = songlist_options}$		:i $PreviewAssetCache$$func$ = $lock_sound$$name$ = %GLOBAL%$music_short_name$		:i $playsound$%GLOBAL%$music$$vol_percent$ = %i(100)$buss$ = $music_setlist$		:i $spawnscriptnow$$music_store_monitor_loop_sound$$params$ = :s{$unique_id$ = %GLOBAL%$unique_id$$music_name$ = %GLOBAL%$music_short_name$$music$ = %GLOBAL%$music$:s}		:i if $ScreenElementExists$${StructQBKey id = songlist_component}$			:i $songlist_component$.$settags$:s{				:i $music_id$ = %GLOBAL%$unique_id$				:i $music_name$ = %GLOBAL%$music_short_name$			:i :s}		:i endif		:i return 	:i endif	:i $wait$${		StructInt 5		StructQBKey gameframes	}$		:i loop_to %i(500)	:i $music_store_turn_off_loading$${StructQBKey desc = songlist_options}$	:i $printf$${StructQBStringQs 0x3175584a}$	:i endfunction]Script music_store_kill_preview_music cc998ebf [	:i $music_store_turn_off_loading$	:i if $ScriptIsRunning$${StructQBKey music_store_request_preview_music}$		:i $KillSpawnedScript$${StructQBKey name = music_store_request_preview_music}$	:i endif	:i if $ScriptIsRunning$${StructQBKey music_store_monitor_loop_sound}$		:i $KillSpawnedScript$${StructQBKey name = music_store_monitor_loop_sound}$	:i endif	:i if $ScreenElementExists$${StructQBKey id = songlist_component}$		:i $songlist_component$.$getsingletag$${StructQBKey music_id}$		:i if $GotParam$${StructQBKey music_id}$			:i if $IsSoundPlayingByID$%GLOBAL%$music_id$				:i $StopSound$$unique_id$ = %GLOBAL%$music_id$			:i endif		:i endif		:i $songlist_component$.$getsingletag$${StructQBKey music_name}$		:i if $GotParam$${StructQBKey music_name}$			:i $PreviewAssetCache$$func$ = $release_sound$$name$ = %GLOBAL%$music_name$		:i endif	:i endif	:i endfunction]Script music_store_turn_on_loading 0x88075f20 [	${StructQBKey desc = SongList_detail}$	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i if $ScreenElementExists$$id$ = %GLOBAL%$desc$		:i %GLOBAL%$desc$.$se_setprops$$loading_alpha$ = %f(1.0)		:i if %GLOBAL%$desc$.$desc_resolvealias$$name$ = $alias_instrument_spinner2$$param$ = $alias_instrument_spinner$			:i %GLOBAL%$alias_instrument_spinner$.$se_setprops$$alpha$ = %f(1.0)			:i %GLOBAL%$alias_instrument_spinner$.$obj_killspawnedscript$$name$ = $music_store_animate_loading$			:i %GLOBAL%$alias_instrument_spinner$.$obj_spawnscriptnow$$music_store_animate_loading$		:i endif		:i if %GLOBAL%$desc$.$desc_resolvealias$$name$ = $alias_instrument_spinner$$param$ = $alias_instrument_spinner$			:i %GLOBAL%$alias_instrument_spinner$.$se_setprops$$alpha$ = %f(1.0)			:i %GLOBAL%$alias_instrument_spinner$.$obj_killspawnedscript$$name$ = $music_store_animate_loading$			:i %GLOBAL%$alias_instrument_spinner$.$obj_spawnscriptnow$$music_store_animate_loading$		:i endif	:i endif	:i endfunction]Script music_store_turn_off_loading 0x448e6b21 [	${StructQBKey desc = SongList_detail}$	:i if $ScreenElementExists$$id$ = %GLOBAL%$desc$		:i %GLOBAL%$desc$.$se_setprops$$loading_alpha$ = %f(0.0)		:i if %GLOBAL%$desc$.$desc_resolvealias$$name$ = $alias_instrument_spinner2$$param$ = $alias_instrument_spinner$			:i %GLOBAL%$alias_instrument_spinner$.$se_setprops$$alpha$ = %f(0.0)			:i %GLOBAL%$alias_instrument_spinner$.$obj_killspawnedscript$$name$ = $music_store_animate_loading$		:i endif		:i if %GLOBAL%$desc$.$desc_resolvealias$$name$ = $alias_instrument_spinner$$param$ = $alias_instrument_spinner$			:i %GLOBAL%$alias_instrument_spinner$.$se_setprops$$alpha$ = %f(0.0)			:i %GLOBAL%$alias_instrument_spinner$.$obj_killspawnedscript$$name$ = $music_store_animate_loading$		:i endif	:i endif	:i endfunction]Script music_store_animate_loading facfcecf [	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i $instrument_spinner_ui_icon_anim$	:i endfunction]Script music_store_monitor_loop_sound c029b8b2 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				unique_id				music_name			]		}		StructQBKey all	}$		:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i while 	:i if $PreviewAssetCache$$func$ = $is_sound_loaded$$name$ = %GLOBAL%$music_name$		:i $PreviewAssetCache$$func$ = $lock_sound$$name$ = %GLOBAL%$music_name$		:i if NOT $IsSoundPlayingByID$%GLOBAL%$unique_id$			:i $wait$${				StructFloat 1.00				StructQBKey seconds			}$						:i $playsound$%GLOBAL%$music$$vol_percent$ = %i(100)$buss$ = $music_setlist$			:i if $ScreenElementExists$${StructQBKey id = songlist_component}$				:i $songlist_component$.$settags$:s{					:i $music_id$ = %GLOBAL%$unique_id$				:i :s}			:i endif		:i endif	:i endif	:i $wait$${		StructInt 5		StructQBKey gameframes	}$		:i loop_to 	:i endfunction]Script marketplace_exit_check daaba469 [	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i $se_getparentid$	:i if $ScreenElementExists$$id$ = %GLOBAL%$parent_id$		:i $LaunchEvent$$type$ = $unfocus$$target$ = %GLOBAL%$parent_id$	:i endif	:i if (~$music_store_attempted_purchase$ = %i(1))		:i $destroy_dialog_box$		:i $songlist_clean_up_spawned_scripts$		:i $body_text$ = ^[03ac90f0]^		:i if $IsPS3$			:i $body_text$ = ~$g_musicstore_ps3_library_instructions$		:i else 			:i $body_text$ = ^[6edb0af6]^		:i endif		:i $create_dialog_box$:s{			:i $no_background$			:i $heading_text$ = ^[cf5deb58]^			:i $body_text$ = %GLOBAL%$body_text$			:i $player_device$ = (~$primary_controller$)			:i $options$ = :a{				:i :s{					:i $text$ = ^[29fff5f2]^					:i $func$ = $marketplace_exit_check_warning_exit$				:i :s}				:i :s{					:i $text$ = ^[d583470f]^					:i $func$ = $marketplace_exit_check_warning_cancel$				:i :s}			:i :a}		:i :s}		:i return 	:i endif	:i if $ui_event_exists_in_stack$${StructString name = "band_lobby"}$		:i %GLOBAL%$back_state$ = $uistate_band_lobby$	:i else 		:i %GLOBAL%$back_state$ = $uistate_mainmenu$	:i endif	:i $generic_event_back_block$$state$ = %GLOBAL%$back_state$$nosound$	:i endfunction]Script marketplace_exit_check_warning 0x51ed26df [	:i $LaunchEvent$${		StructQBKey type = unfocus		StructQBKey target = music_store_hub_vmenu	}$		:i $destroy_dialog_box$	:i $create_dialog_box$:s{		:i $template$ = %GLOBAL%$template$		:i $heading_text$ = %GLOBAL%$Title$		:i $body_text$ = %GLOBAL%$body_text$		:i $options$ = %GLOBAL%$options$		:i $player_device$ = (~$primary_controller$)	:i :s}	:i endfunction]Script marketplace_exit_check_warning_cancel 0x539f64d0 [	:i $destroy_dialog_box$	:i $LaunchEvent$${		StructQBKey type = unfocus		StructQBKey target = music_store_hub_vmenu	}$		:i $LaunchEvent$${		StructQBKey type = focus		StructQBKey target = music_store_hub_vmenu	}$		:i $music_store_hub_create_default_user_control_helpers$	:i endfunction]Script marketplace_exit_check_warning_exit f522e304 [	:i $destroy_dialog_box$	:i $LaunchEvent$${		StructQBKey type = focus		StructQBKey target = music_store_hub_vmenu		StructStruct Data		{			StructHeader			{				StructInt child_index = 0			}		}	}$		:i if $ui_event_exists_in_stack$${StructString name = "band_lobby"}$		:i %GLOBAL%$back_state$ = $uistate_band_lobby$	:i else 		:i %GLOBAL%$back_state$ = $uistate_mainmenu$	:i endif	:i $generic_event_back$$state$ = %GLOBAL%$back_state$$nosound$	:i endfunction]Script music_store_purchase_content 0x8438d730 [	${Unknown [00012b009e022a846969696900000000]}$	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i $printf$${StructString 0x00000000 = "music_store_purchase_content - Starting checkout"}$	:i $printstruct$%GLOBAL%$purchase_struct$	:i $change$${StructInt music_store_attempted_purchase = 1}$	:i $change$${StructInt generic_menu_block_input = 1}$	:i $PushUnsafeForShutdown$${StructQBKey context = music_store_purchase_content}$	:i if $IsPS3$		:i $destroy_band$		:i $destroy_song_and_musicstudio_heaps$${StructQBKey do_unloads}$		:i $VMHeap$${StructQBKey func = swap_out}$		:i $VMHeap$${StructQBKey func = alloc_commerce}$	:i endif	:i $MarketplaceFunc$$func$ = $checkout$$id$ = (%GLOBAL%$purchase_struct$->$code$)	:i while 	:i $MarketplaceFunc$${StructQBKey func = get_state}$	:i if NOT (%GLOBAL%$state$ = $checkout$)		:i if NOT (%GLOBAL%$state$ = $download$)			:i continue		:i endif	:i endif	:i $wait$${		StructInt 1		StructQBKey gameframe	}$		:i loop_to 	:i if $MarketplaceFunc$${StructQBKey func = completed_checkout}$		:i $change$${StructInt g_ps3_dlc_scan_occured = 0}$		:i if $StructureContains$$structure$ = %GLOBAL%$purchase_struct$$song_checksum$			:i $broadcastevent$$type$ = $dlc_purchased$$Data$ = :s{$player$ = %i(1)$controller_index$ = (~$primary_controller$)$store_purchase$ = (%GLOBAL%$purchase_struct$->$song_checksum$):s}		:i endif	:i endif	:i $PopUnsafeForShutdown$${StructQBKey context = music_store_purchase_content}$	:i $change$${StructInt generic_menu_block_input = 0}$	:i $printf$${StructString 0x00000000 = "music_store_purchase_content - Done checkout"}$	:i endfunction]