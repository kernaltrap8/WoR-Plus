Unknown [1c00000000000000000014b80000000000000000]SectionQBKey calibrate_lag_song BloodlinesSectionQBKey calibrate_last_song_saved nullSectionInteger calibrate_lag_miss_avg_threshold_ms 200SectionInteger calibrate_lag_miss_threshold_max_ms 500SectionInteger calibrate_lag_failed_num 0SectionInteger calibrate_lag_fail_threshold_num 3SectionInteger calibrate_saved_video_offset 0SectionInteger calibrate_saved_audio_offset 0Script ui_options_calibrate_restore_songlist 0x14fe83ea [	:i $Playlist_RemoveFirstSong$	:i if (~$calibrate_last_song_saved$ !== $null$)		:i while 		:i $Playlist_GetCurrentSong$		:i if (%GLOBAL%$current_song$ = ~$calibrate_last_song_saved$)			:i continue		:i endif		:i if $Playlist_IsFinished$			:i continue		:i endif		:i $Playlist_SwitchToNextSong$		:i loop_to 	:i endif	:i $change$${StructQBKey calibrate_last_song_saved = null}$	:i endfunction]Script ui_options_calibrate_cancel 0x7f3dbfe8 [	:i $SetGlobalTags$$user_options$$params$ = :s{$lag_video_calibration$ = (~$calibrate_saved_video_offset$)$lag_audio_calibration$ = (~$calibrate_saved_audio_offset$):s}	:i $hide_glitch$${StructInt num_frames = 20}$	:i $ui_options_calibrate_restore_songlist$	:i $ui_calibrate_pausemenu_choose_quit$	:i $idx$ = %i(0)	:i while 	:i $SetPlayerInfo$(%GLOBAL%$idx$ + %i(1))$in_game$ = (~$calibrate_prev_parts$:a{%GLOBAL%$idx$:a}->$in_game$)	:i $idx$ = (%GLOBAL%$idx$ + %i(1))	:i loop_to %i(4)	:i endfunction]Script ui_calibrate_option_choose 0x41dee222 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				menu_choice			]		}		StructQBKey all	}$		:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i $UI_SFX$${		StructQBKey menustate = generic		StructQBKey uitype = select	}$		:i $change$${StructInt calibrate_test_from_menu = 0}$	:i switch (%GLOBAL%$menu_choice$)		:i case $adjust_video_lag$			:i $calibrate_highway_events_container$.$settags$${StructQBKey current_changing = video}$			:i $wait$${				StructInt 1				StructQBKey gameframe			}$						:i $LaunchEvent$${				StructQBKey type = unfocus				StructQBKey target = generic_barrel_vmenu			}$						:i $LaunchEvent$${				StructQBKey type = focus				StructQBKey target = calibrate_highway_events_container			}$						:i endcase		case $adjust_audio_lag$			:i $calibrate_highway_events_container$.$settags$${StructQBKey current_changing = audio}$			:i $LaunchEvent$${				StructQBKey type = unfocus				StructQBKey target = generic_barrel_vmenu			}$						:i $LaunchEvent$${				StructQBKey type = focus				StructQBKey target = calibrate_highway_events_container			}$						:i endcase		case $reset_lags$			:i $ui_calibrate_reset_change$			:i endcase		case $note_calibrate$			:i $change$${StructQBStringQs calibrating_helper_text = 0x0eb9e981}$			:i $jump_in_calibrate$			:i endcase		case $settingstest$			:i $jump_in_calibrate$${StructQBKey for_testing}$			:i endcase		case $save_and_exit$			:i $LaunchEvent$${				StructQBKey type = unfocus				StructQBKey target = generic_barrel_vmenu			}$						:i $get_lag_values$			:i $SetGlobalTags$$user_options$$params$ = :s{$lag_video_calibration$ = %GLOBAL%$video_offset$$lag_audio_calibration$ = (~$current_calibrate_audio_lag$):s}			:i $calibrate_highway_shutdown$${StructInt load_band_lobby_pak = 1}$			:i $hide_glitch$${StructInt num_frames = 8}$			:i $ui_options_calibrate_restore_songlist$			:i $ui_calibrate_reset_practice_data$			:i if (%GLOBAL%$practice_enabled$ = %i(1))				:i if $GotParam$${StructQBKey nosave}$					:i $SpawnScriptLater$${StructQBKey practice_restart_song}$				:i else 					:i $change$${StructQBKey memcard_after_func = practice_restart_song}$				:i endif				:i $state$ = $UIState_Gameplay$			:i else 				:i if $ui_event_exists_in_stack$${StructString name = "jam"}$					:i $change$${StructInt gameplay_restart_song = 1}$					:i $state$ = $UIState_Gameplay$				:i elseif $ui_event_exists_in_stack$${StructString name = "band_lobby"}$					:i $change$${StructInt gameplay_restart_song = 1}$					:i $state$ = $UIState_Gameplay$				:i elseif $ui_event_exists_in_stack$${StructString name = "select_training"}$					:i $change$${StructInt gameplay_restart_song = 1}$					:i $state$ = $UIState_Gameplay$				:i elseif $ui_event_exists_in_stack$${StructString name = "options"}$					:i $state$ = $uistate_options$				:i else 					:i $state$ = $uistate_mainmenu$				:i endif			:i endif			:i $idx$ = %i(0)			:i while 			:i $SetPlayerInfo$(%GLOBAL%$idx$ + %i(1))$in_game$ = (~$calibrate_prev_parts$:a{%GLOBAL%$idx$:a}->$in_game$)			:i $idx$ = (%GLOBAL%$idx$ + %i(1))			:i loop_to %i(4)			:i if $GotParam$${StructQBKey nosave}$				:i $UI_SFX$${					StructQBKey menustate = generic					StructQBKey uitype = select				}$								:i $generic_event_back$$state$ = %GLOBAL%$state$$Data$ = :s{$from_calibrate_lag$ = %i(1):s}			:i else 				:i $ui_memcard_autosave$$event$ = $menu_back$$state$ = %GLOBAL%$state$$Data$ = :s{$from_calibrate_lag$ = %i(1):s}$show_mainmenu_bg$ = %i(1)			:i endif			:i endcase		case $cancel$			:i $ui_options_calibrate_cancel$	:i end_switch	:i endfunction]Script ui_calibrate_option_back 0x05a30c1b [	:i $UI_SFX$${		StructQBKey menustate = generic		StructQBKey uitype = back	}$		:i $LaunchEvent$${		StructQBKey type = unfocus		StructQBKey target = calibrate_highway_events_container	}$		:i $LaunchEvent$${		StructQBKey type = unfocus		StructQBKey target = generic_barrel_vmenu	}$		:i endfunction]Script jump_in_calibrate e6d8184b [	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i if $GotParam$${StructQBKey for_testing}$		:i $change$${StructQBKey calibrate_highway_gameplay_state = settingstest}$		:i $change$${StructInt calibrate_test_from_menu = 1}$	:i else 		:i $ui_calibrate_reset_change$	:i endif	:i $LaunchEvent$${		StructQBKey type = unfocus		StructQBKey target = generic_barrel_vmenu	}$		:i $generic_barrel_vmenu$.$se_setprops$${		StructInt alpha = 0		StructFloat time = 0.5	}$		:i $generic_barrel_menu$.$se_setprops$${		StructInt highlight_btn_alpha = 0		StructFloat time = 0.5	}$		:i if $generic_barrel_menu$.$desc_resolvealias$${StructQBKey name = alias_generic_barrel_menu_up_arrow}$		:i %GLOBAL%$resolved_id$.$se_setprops$$alpha$ = %i(0)$time$ = %f(0.5)	:i endif	:i if $generic_barrel_menu$.$desc_resolvealias$${StructQBKey name = alias_generic_barrel_menu_down_arrow}$		:i %GLOBAL%$resolved_id$.$se_setprops$$alpha$ = %i(0)$time$ = %f(0.5)	:i endif	:i $generic_barrel_menu$.$se_waitprops$	:i $generic_barrel_vmenu$.$se_waitprops$	:i $spawnscriptnow$${		StructQBKey mock_highway_restart		StructStruct params		{			StructHeader			{				StructInt fade_helpers = 1				StructInt enable_input = 1			}		}	}$		:i endfunction]Script ui_calibrate_reset_change cc8b92ba [	:i $FormatText$${		StructQBKey textname = video_text		StructQBStringQs 0x0f904228		StructInt d = 0	}$		:i $FormatText$${		StructQBKey textname = audio_text		StructQBStringQs 0x6172b8bf		StructInt d = 0	}$		:i $change$${StructInt calibrate_highway_video_offset = 0}$	:i $change$${StructInt current_calibrate_audio_lag = 0}$	:i $SetGlobalTags$${		StructQBKey user_options		StructStruct params		{			StructHeader			{				StructInt lag_video_calibration = 0				StructInt lag_audio_calibration = 0			}		}	}$		:i $CalibrationInterface$.$se_setprops$$videolag_text$ = %GLOBAL%$video_text$$audiolag_text$ = %GLOBAL%$audio_text$	:i $calibrate_highway_events_container$.$settags$${		StructInt temp_video_offset = 0		StructInt temp_audio_offset = 0	}$		:i endfunction]Script ui_calibrate_lag_change 0x0aae8db0 [	:i $calibrate_highway_events_container$.$gettags$	:i %GLOBAL%$video_offset$ = %GLOBAL%$temp_video_offset$	:i %GLOBAL%$audio_offset$ = %GLOBAL%$temp_audio_offset$	:i if $GotParam$${StructQBKey up}$		:i $change_val$ = %i(4294967295)	:i elseif $GotParam$${StructQBKey down}$		:i $change_val$ = %i(1)	:i endif	:i $should_return$ = %i(0)	:i if (%GLOBAL%$current_changing$ = $video$)		:i $video_offset$ = (%GLOBAL%$video_offset$ + %GLOBAL%$change_val$)		:i if (%GLOBAL%$video_offset$ > %i(0))			:i $should_return$ = %i(1)		:i endif		:i if (%GLOBAL%$video_offset$ < %i(4294967096))			:i $should_return$ = %i(1)		:i endif	:i elseif (%GLOBAL%$current_changing$ = $audio$)		:i $change_val$ = (%GLOBAL%$change_val$ * %i(4294967295))		:i $audio_offset$ = (%GLOBAL%$audio_offset$ + %GLOBAL%$change_val$)		:i if (%GLOBAL%$audio_offset$ < %i(0))			:i $should_return$ = %i(1)		:i endif		:i if (%GLOBAL%$audio_offset$ > %i(200))			:i $should_return$ = %i(1)		:i endif	:i endif	:i if (%GLOBAL%$should_return$ = %i(1))		:i return 	:i endif	:i $UI_SFX$${		StructQBKey menustate = generic		StructQBKey uitype = ScrollUp	}$		:i $FormatText$$textname$ = $video_text$^[0f904228]^$d$ = (%GLOBAL%$video_offset$ * %i(4294967295))	:i $FormatText$$textname$ = $audio_text$^[6172b8bf]^$d$ = %GLOBAL%$audio_offset$	:i $calibrate_highway_events_container$.$settags$:s{		:i $temp_video_offset$ = %GLOBAL%$video_offset$		:i $temp_audio_offset$ = %GLOBAL%$audio_offset$	:i :s}	:i $CalibrationInterface$.$se_setprops$$videolag_text$ = %GLOBAL%$video_text$$audiolag_text$ = %GLOBAL%$audio_text$	:i endfunction]Script ui_calibrate_option_focus deefba3f [	:i $gettags$	:i if $GotParam$${StructQBKey current_changing}$		:i if (%GLOBAL%$current_changing$ = $video$)			:i $CalibrationInterface$.$se_setprops$${				StructArray videolag_rgba				{					ArrayInteger					[						166						30						45						255					]				}				StructFloat calibrate_lag_video_alpha = 1.00			}$					:i elseif (%GLOBAL%$current_changing$ = $audio$)			:i $CalibrationInterface$.$se_setprops$${				StructArray audiolag_rgba				{					ArrayInteger					[						166						30						45						255					]				}				StructFloat calibrate_lag_audio_alpha = 1.00			}$					:i endif	:i endif	:i $calibrate_highway_setup_button_helpers$${StructInt add_back_pill = 1}$	:i endfunction]Script ui_calibrate_option_unfocus 0x634eb410 [	:i $gettags$	:i if $GotParam$${StructQBKey current_changing}$		:i if (%GLOBAL%$current_changing$ = $video$)			:i $CalibrationInterface$.$se_setprops$${				StructArray videolag_rgba				{					ArrayInteger					[						30						30						30						255					]				}				StructFloat calibrate_lag_video_alpha = 0.699999988079071			}$					:i elseif (%GLOBAL%$current_changing$ = $audio$)			:i $CalibrationInterface$.$se_setprops$${				StructArray audiolag_rgba				{					ArrayInteger					[						30						30						30						255					]				}				StructFloat calibrate_lag_audio_alpha = 0.699999988079071			}$					:i endif	:i else 		:i $obj_getid$		:i %GLOBAL%$ObjID$.$se_setprops$$rgba$ = :a{%i(70)%i(70)%i(70)%i(255):a}	:i endif	:i endfunction]SectionArray calibrate_saved_practice_info{	ArrayInteger	[		0		0		0		0	]}SectionInteger calibrate_pushed_unsafe 0Script choose_calibrate_lag 0x1dbd8263 [	:i $SetSpawnInstanceLimits$${		StructInt max = 1		StructQBKey management = ignore_spawn_request	}$		:i $PushUnsafeForShutdown$${		StructQBKey context = calibrate		StructQBKey type = unchecked	}$		:i $change$${StructInt calibrate_pushed_unsafe = 1}$	:i $Playlist_GetCurrentSong$	:i if (%GLOBAL%$current_song$ = $jamsession$)		:i $unload_songqpak$	:i endif	:i $change$$calibrate_last_song_saved$ = %GLOBAL%$current_song$	:i $Playlist_AddSong$$song$ = (~$calibrate_lag_song$)$insert_at$ = $front$	:i $quickplay_unload_challenges$	:i $get_lag_values$	:i $change$$calibrate_saved_video_offset$ = %GLOBAL%$video_offset$	:i $change$$calibrate_saved_audio_offset$ = %GLOBAL%$audio_offset$	:i $net_counter_increment$${StructQBKey counter_name = globalcounter_calibrate_lag}$	:i $practice_enabled$ = %i(0)	:i if (~$game_mode$ = $practice$)		:i $practice_enabled$ = %i(1)	:i endif	:i $SetArrayElement$$arrayName$ = $calibrate_saved_practice_info$$globalarray$$index$ = %i(0)$newValue$ = %GLOBAL%$practice_enabled$	:i $SetArrayElement$$arrayName$ = $calibrate_saved_practice_info$$globalarray$$index$ = %i(1)$newValue$ = (~$practice_start_time$)	:i $SetArrayElement$$arrayName$ = $calibrate_saved_practice_info$$globalarray$$index$ = %i(2)$newValue$ = (~$practice_end_time$)	:i $SetArrayElement$$arrayName$ = $calibrate_saved_practice_info$$globalarray$$index$ = %i(3)$newValue$ = (~$current_starttime$)	:i $reset_practice_mode$	:i $shut_down_practice_mode$	:i $kill_gem_scroller$${StructInt no_render = 1}$	:i $change$${StructInt calibrate_lag_enabled = 1}$	:i $change$$calibrate_lag_previous_mode$ = (~$game_mode$)	:i $change$${StructQBKey game_mode = quickplay}$	:i $get_controller_type$$controller_index$ = (~$primary_controller$)	:i if NOT (%GLOBAL%$controller_type$ = $controller$)		:i $part$ = %GLOBAL%$controller_type$	:i else 		:i $part$ = $guitar$	:i endif	:i if (%GLOBAL%$part$ = $Vocals$)		:i $part$ = $guitar$	:i endif	:i $ResetYieldInfo$${StructQBKey yield = false}$	:i if $ui_event_exists_in_stack$${StructString name = "gameplay"}$		:i $change$${StructInt gameplay_restart_song = 1}$		:i $generic_event_back$${			StructQBKey nosound			StructQBKey state = UIState_Gameplay		}$			:i else 		:i $generic_event_choose$${			StructQBKey no_sound			StructQBKey state = uistate_play_song		}$			:i endif	:i $spawnscriptnow$$calibrate_highway_start_song$$params$ = :s{$device_num$ = (~$primary_controller$)$part$ = %GLOBAL%$part$:s}	:i endfunction]Script ui_calibrate_pausemenu 0x7374df98 [	:i $show_option$ = %i(0)	:i $num_options$ = %i(0)	:i $new_option$ = :s{		:i $text$ = ^[b8790f2f]^		:i $func$ = $ui_calibrate_pausemenu_choose_skip$		:i $func_params$ = :s{$state$ = $video$:s}	:i :s}	:i if $ScreenElementExists$${StructQBKey id = calibrate_highway_container}$		:i if (~$calibrate_highway_state$ = $video$)			:i $show_option$ = %i(1)		:i endif	:i endif	:i $AddArrayElement$$array$ = %GLOBAL%$options$$element$ = %GLOBAL%$new_option$	:i %GLOBAL%$options$ = %GLOBAL%$array$	:i if (%GLOBAL%$show_option$ = %i(1))		:i $new_option$ = :s{			:i $text$ = ^[f6a0ac6e]^			:i $func$ = $ui_calibrate_pausemenu_choose_skip$			:i $func_params$ = :s{$state$ = $audio$$reset_pause_script$:s}		:i :s}		:i $AddArrayElement$$array$ = %GLOBAL%$options$$element$ = %GLOBAL%$new_option$		:i %GLOBAL%$options$ = %GLOBAL%$array$		:i $num_options$ = (%GLOBAL%$num_options$ + %i(1))	:i endif	:i if NOT $ui_event_exists_in_stack$${StructString name = "options"}$		:i $back_to_text$ = ^[84aa9787]^		:i $new_option$ = :s{			:i $text$ = %GLOBAL%$back_to_text$			:i $func$ = $ui_calibrate_pausemenu_back_to_game$		:i :s}		:i $AddArrayElement$$array$ = %GLOBAL%$options$$element$ = %GLOBAL%$new_option$		:i %GLOBAL%$options$ = %GLOBAL%$array$		:i $num_options$ = (%GLOBAL%$num_options$ + %i(1))	:i endif	:i $new_option$ = :s{		:i $text$ = ^[67d9c56d]^		:i $func$ = $ui_calibrate_pausemenu_choose_quit$	:i :s}	:i $AddArrayElement$$array$ = %GLOBAL%$options$$element$ = %GLOBAL%$new_option$	:i %GLOBAL%$options$ = %GLOBAL%$array$	:i $num_options$ = (%GLOBAL%$num_options$ + %i(1))	:i if (%GLOBAL%$num_options$ > %i(0))		:i return $options$ = %GLOBAL%$options$	:i endif	:i endfunction]Script ui_calibrate_pausemenu_choose_skip 0x63633059 [	:i $UI_SFX$${		StructQBKey menustate = generic		StructQBKey uitype = select	}$		:i $setup_pause$${StructQBKey pad_start_script = calibrate_hit_pause}$	:i $ui_calibrate_skip$$state$ = %GLOBAL%$state$	:i $generic_event_back$	:i $UnPauseGame$	:i endfunction]Script ui_calibrate_skip 0x3b21c254 [	${StructInt fade_helpers = 1}$	:i $change$$calibrate_highway_gameplay_state$ = %GLOBAL%$state$	:i $calibrate_highway_kill_scripts$	:i $LaunchEvent$${		StructQBKey type = unfocus		StructQBKey target = calibrate_highway_events_container	}$		:i $calibrate_highway_events_container$.$settags$${StructQBKey current_changing = None}$	:i $CalibrationInterface$.$se_setprops$${		StructInt helper_alpha = 0		StructFloat time = 0.25	}$		:i $CalibrationInterface$.$se_waitprops$	:i $spawnscriptnow$$mock_highway_restart$$params$ = :s{ isNull :s}	:i endfunction]Script ui_calibrate_reset_practice_data 0x630fa328 [	:i $practice_enabled$ = (~$calibrate_saved_practice_info$:a{%i(0):a})	:i $change$$practice_start_time$ = (~$calibrate_saved_practice_info$:a{%i(1):a})	:i $change$$practice_end_time$ = (~$calibrate_saved_practice_info$:a{%i(2):a})	:i $change$$current_starttime$ = (~$calibrate_saved_practice_info$:a{%i(3):a})	:i return $practice_enabled$ = %GLOBAL%$practice_enabled$	:i endfunction]Script ui_calibrate_pausemenu_back_to_game 0x3e7d14fc [	:i if NOT $GotParam$${StructQBKey no_shutdown}$		:i $calibrate_highway_shutdown$	:i endif	:i $ui_calibrate_reset_practice_data$	:i if (%GLOBAL%$practice_enabled$ = %i(1))		:i $practice_restart_song$	:i else 		:i $change$${StructInt gameplay_restart_song = 1}$		:i $generic_event_back$${			StructQBKey state = UIState_Gameplay			StructQBKey nosound			StructStruct Data			{				StructHeader				{					StructInt from_calibrate_lag = 1				}			}		}$			:i endif	:i endfunction]Script ui_calibrate_pausemenu_choose_quit 0x549538f6 [	:i $hide_glitch$${StructInt num_frames = 8}$	:i $calibrate_highway_shutdown$	:i if $ui_event_exists_in_stack$${StructString name = "band_lobby"}$		:i $ui_calibrate_pausemenu_back_to_game$${StructQBKey no_shutdown}$		:i return 	:i elseif $ui_event_exists_in_stack$${StructString name = "select_training"}$		:i $ui_calibrate_pausemenu_back_to_game$${StructQBKey no_shutdown}$		:i return 	:i elseif $ui_event_exists_in_stack$${StructString name = "options"}$		:i $quit_to_state$ = $uistate_options$	:i elseif $ui_event_exists_in_stack$${StructString name = "jam"}$		:i $quit_to_state$ = $UIstate_jam$	:i else 		:i $quit_to_state$ = $uistate_mainmenu$	:i endif	:i $generic_event_back$$state$ = %GLOBAL%$quit_to_state$$nosound$	:i endfunction]Script get_lag_values 0x09470a4a [	:i $GetGlobalTags$${		StructQBKey user_options		StructQBKey param = lag_audio_calibration	}$		:i $GetGlobalTags$${		StructQBKey user_options		StructQBKey param = lag_video_calibration	}$		:i if $GotParam$${StructQBKey lag_audio_calibration}$		:i if $GotParam$${StructQBKey lag_video_calibration}$			:i $CastToInteger$${StructQBKey lag_audio_calibration}$			:i $CastToInteger$${StructQBKey lag_video_calibration}$			:i $audio_offset$ = %GLOBAL%$lag_audio_calibration$			:i $video_offset$ = %GLOBAL%$lag_video_calibration$		:i endif	:i endif	:i return $audio_offset$ = %GLOBAL%$audio_offset$$video_offset$ = %GLOBAL%$video_offset$	:i endfunction]Script use_alternate_if_in_calibrate 0x5d41bc21 [	:i if (~$calibrate_lag_enabled$ = %i(1))		:i return ${StructQBKey true}$	:i else 		:i return ${StructQBKey false}$	:i endif	:i endfunction]