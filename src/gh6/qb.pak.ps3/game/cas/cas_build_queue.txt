Unknown [1c00000000000000000024a00000000000000000]SectionArray cas_object_name_list{	ArrayQBKey	[		musician1		musician2		musician3		musician4	]}SectionInteger cas_queue_min_frames_between_jobs 12SectionInteger cas_queue_min_frames_between_jobs_fast_cas 6Script cas_queue_add_request ba5ac352 [	$character_id$ = (~$cas_current_profile$)$Instrument$ = $None$$has_mic$ = %i(0)$persistent_band$ = %i(0)	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				appearance			]		}		StructQBKey all	}$		:i if NOT $GotParam$${StructQBKey player}$		:i $RequireParams$${			StructArray 0x00000000			{				ArrayQBKey				[					index				]			}			StructQBKey all		}$				:i $player$ = %i(4294967295)	:i endif	:i if NOT $GotParam$${StructQBKey savegame}$		:i $savegame$ = (~$cas_current_savegame$)	:i endif	:i if NOT $GotParam$${StructQBKey character_id}$		:i $character_id$ = (~$cas_current_profile$)	:i endif	:i if NOT $GotParam$${StructQBKey index}$		:i if ((%GLOBAL%$player$ < %i(1)) OR (%GLOBAL%$player$ > %i(4)))			:i $scriptassert$%s("player must be 1-4. player = %p")$p$ = %GLOBAL%$player$		:i endif		:i $index$ = (%GLOBAL%$player$ - %i(1))	:i endif	:i $get_appearance_checksum$:s{$appearance$ = %GLOBAL%$appearance$$Instrument$ = %GLOBAL%$Instrument$$mic$ = %GLOBAL%$has_mic$:s}	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})	:i if NOT $GotParam$${StructQBKey force_update}$		:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$object$			:i $old_object$ = (%GLOBAL%$player_info$->$object$)		:i endif		:i if $cas_queue_is_busy$			:i if ((~$cas_queue_current_job$->$current_player_index$) = %GLOBAL%$index$)				:i if ((~$cas_queue_current_job$->$appearance_checksum$) = %GLOBAL%$new_appearance_checksum$)					:i $printf$${StructString 0x00000000 = "cas_queue_add_request - Already have this appearance"}$					:i return ${StructQBKey false}$				:i endif				:i $CasCancelLoading$				:i $cancelled_loading$ = %i(1)				:i $printf$%s("Cancelled existing load on %d")$d$ = %GLOBAL%$player$				:i if $GotParam$${StructQBKey old_object}$					:i if $CompositeObjectExists$$name$ = %GLOBAL%$old_object$						:i if NOT %GLOBAL%$old_object$.$getsingletag$$body_checksum$							:i $scriptassert$${StructString 0x00000000 = "body_checksum missing from object"}$						:i endif						:i $current_body_checksum$ = %GLOBAL%$body_checksum$					:i endif				:i endif			:i endif		:i endif		:i if NOT $GotParam$${StructQBKey cancelled_loading}$			:i if $GotParam$${StructQBKey old_object}$				:i if $CompositeObjectExists$$name$ = %GLOBAL%$old_object$					:i if %GLOBAL%$old_object$.$getsingletag$$appearance_checksum$						:i if (%GLOBAL%$appearance_checksum$ = %GLOBAL%$new_appearance_checksum$)							:i $printf$${StructString 0x00000000 = "cas_queue_add_request - Already have this appearance in old cancelled object"}$							:i $cas_queue_remove_job_details$$player_info$ = %GLOBAL%$player_info$$index$ = %GLOBAL%$index$							:i return ${								StructQBKey false								StructInt character_is_finished = 1							}$													:i endif					:i endif					:i if NOT %GLOBAL%$old_object$.$getsingletag$$body_checksum$						:i $scriptassert$${StructString 0x00000000 = "body_checksum missing from object"}$					:i endif					:i $current_body_checksum$ = %GLOBAL%$body_checksum$				:i else 					:i $printf$${StructString 0x00000000 = "Old object does not exist"}$				:i endif			:i endif		:i endif	:i endif	:i $fast_cas_update$ = %i(0)	:i if $GotParam$${StructQBKey in_cas}$		:i $get_body_checksum_from_appearance$$appearance$ = %GLOBAL%$appearance$		:i if $GotParam$${StructQBKey current_body_checksum}$			:i if (%GLOBAL%$current_body_checksum$ = %GLOBAL%$body_checksum$)				:i $fast_cas_update$ = %i(1)			:i endif		:i endif	:i endif	:i $GetLogicFrame$	:i $printf$%s("Building character %c")$c$ = %GLOBAL%$character_id$	:i $get_is_female_from_appearance$$appearance$ = %GLOBAL%$appearance$	:i $player_info$ = :s{		:i %GLOBAL%$player_info$		:i $pending_appearance$ = %GLOBAL%$appearance$		:i $pending_instrument$ = %GLOBAL%$Instrument$		:i $pending_is_female$ = %GLOBAL%$is_female$		:i $requested_frame$ = %GLOBAL%$logicframe$		:i $fast_cas_update$ = %GLOBAL%$fast_cas_update$		:i $hide_old_character$ = %GLOBAL%$hide_old_character$		:i $appearance_checksum$ = %GLOBAL%$new_appearance_checksum$		:i $character_id$ = %GLOBAL%$character_id$		:i $savegame$ = %GLOBAL%$savegame$		:i $player$ = %GLOBAL%$player$		:i $has_mic$ = %GLOBAL%$has_mic$		:i $stored_character_index$ = %GLOBAL%$stored_character_index$	:i :s}	:i $SetArrayElement$$arrayName$ = $cas_queue_player_info$$globalarray$$index$ = %GLOBAL%$index$$newValue$ = %GLOBAL%$player_info$	:i $spawnscriptnow$$cas_queue_update$$params$ = :s{$new_request_index$ = %GLOBAL%$index$$persistent_band$ = %GLOBAL%$persistent_band$:s}	:i return ${StructQBKey true}$	:i endfunction]Script cas_queue_kill_player b1da2ee0 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				player			]		}		StructQBKey all	}$		:i if ((%GLOBAL%$player$ < %i(1)) OR (%GLOBAL%$player$ > %i(4)))		:i $scriptassert$${StructString 0x00000000 = "player must be 1-4"}$	:i endif	:i $index$ = (%GLOBAL%$player$ - %i(1))	:i if $cas_queue_is_busy$		:i if ((~$cas_queue_current_job$->$current_player_index$) = %GLOBAL%$index$)			:i $CasCancelLoading$			:i if $StructureContains$${					StructQBString structure = cas_queue_current_job					StructQBKey old_object				}$								:i $old_object$ = (~$cas_queue_current_job$->$old_object$)				:i if $CompositeObjectExists$$name$ = %GLOBAL%$old_object$					:i $cas_queue_internal_destroy_object$$object$ = %GLOBAL%$old_object$$kill_pending_jobs$					:i return 				:i endif			:i endif		:i endif	:i endif	:i if $cas_player_has_character_object$$player$ = %GLOBAL%$player$		:i $cas_queue_internal_destroy_object$$object$ = %GLOBAL%$character_object$$kill_pending_jobs$	:i endif	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})	:i $cas_queue_remove_job_details$$player_info$ = %GLOBAL%$player_info$$index$ = %GLOBAL%$index$	:i endfunction]Script cas_queue_update 0x85672353 [	:i $setscriptcannotpause$	:i if $ScriptIsRunning$${StructQBKey UpdateCurrentCASModelSpawned}$		:i $printf$${StructString 0x00000000 = "cas_queue_is_busy: UpdateCurrentCASModelSpawned is running"}$		:i return 	:i endif	:i if $GotParam$${StructQBKey new_request_index}$		:i $cas_start_loading_anim$$player_index$ = %GLOBAL%$new_request_index$	:i endif	:i if $cas_queue_is_busy$		:i return 	:i endif	:i $OnExitRun$${StructQBKey cas_queue_update_death}$	:i if (~$cas_queue_lock$ = %i(1))		:i $scriptassert$${StructString 0x00000000 = "cas_queue_lock"}$	:i endif	:i $change$${StructInt cas_queue_lock = 1}$	:i if $cas_queue_get_next_entry$		:i $cas_start_loading_anim$$player_index$ = %GLOBAL%$index$		:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})		:i $fast_cas_update$ = (%GLOBAL%$player_info$->$fast_cas_update$)		:i $new_appearance$ = (%GLOBAL%$player_info$->$pending_appearance$)		:i $new_instrument$ = (%GLOBAL%$player_info$->$pending_instrument$)		:i $hide_old_character$ = (%GLOBAL%$player_info$->$hide_old_character$)		:i $character_id$ = (%GLOBAL%$player_info$->$character_id$)		:i $savegame$ = (%GLOBAL%$player_info$->$savegame$)		:i $appearance_checksum$ = (%GLOBAL%$player_info$->$appearance_checksum$)		:i $has_mic$ = (%GLOBAL%$player_info$->$has_mic$)		:i $cas_queue_prepare_new_object$$player_info$ = %GLOBAL%$player_info$$index$ = %GLOBAL%$index$		:i $cas_queue_start_job$$new_object$ = %GLOBAL%$new_object$$old_object$ = %GLOBAL%$old_object$$index$ = %GLOBAL%$index$		:i $min_frames$ = (~$cas_queue_min_frames_between_jobs$)		:i if (%GLOBAL%$fast_cas_update$ = %i(1))			:i $min_frames$ = (~$cas_queue_min_frames_between_jobs_fast_cas$)		:i endif		:i if (~$cas_queue_waiting_to_start_cancelled$ = %i(1))			:i $scriptassert$${StructString 0x00000000 = "This should never be set here"}$		:i endif		:i $change$${StructInt cas_queue_waiting_to_start = 1}$		:i while 		:i $GetLogicFrame$		:i $waited$ = (%GLOBAL%$logicframe$ - (~$cas_queue_last_job_frame$))		:i if (%GLOBAL%$waited$ >= %GLOBAL%$min_frames$)			:i continue		:i endif		:i if (~$cas_queue_waiting_to_start_cancelled$ = %i(1))			:i continue		:i endif		:i if (%GLOBAL%$persistent_band$ = %i(1))			:i continue		:i endif		:i $wait$${			StructInt 1			StructQBKey gameframe		}$				:i $printf$${StructString 0x00000000 = "Waiting due to CAS queue spamming..."}$		:i loop_to 		:i $BlockForScript$${StructQBKey UpdateCurrentCASModelSpawned}$		:i $change$$cas_queue_last_job_frame$ = %GLOBAL%$logicframe$		:i $change$${StructInt cas_queue_waiting_to_start = 0}$		:i if (~$cas_queue_waiting_to_start_cancelled$ = %i(0))			:i if (%GLOBAL%$fast_cas_update$ = %i(1))				:i $cas_queue_fast_update$:s{					:i $cas_object$ = %GLOBAL%$new_object$					:i $appearance$ = %GLOBAL%$new_appearance$					:i $Instrument$ = %GLOBAL%$new_instrument$					:i $appearance_checksum$ = %GLOBAL%$appearance_checksum$				:i :s}			:i else 				:i $cas_queue_build_new_character$:s{					:i $index$ = %GLOBAL%$index$					:i $old_object$ = %GLOBAL%$old_object$					:i $new_object$ = %GLOBAL%$new_object$					:i $profile$ = :s{						:i $appearance$ = %GLOBAL%$new_appearance$					:i :s}					:i $Instrument$ = %GLOBAL%$new_instrument$					:i $hide_old_character$ = %GLOBAL%$hide_old_character$					:i $appearance_checksum$ = %GLOBAL%$appearance_checksum$					:i $character_id$ = %GLOBAL%$character_id$					:i $savegame$ = %GLOBAL%$savegame$					:i $has_mic$ = %GLOBAL%$has_mic$				:i :s}			:i endif		:i else 			:i $printf$${StructString 0x00000000 = "Cancelled during the waiting_to_start"}$			:i $change$${StructInt cas_queue_waiting_to_start_cancelled = 0}$		:i endif		:i if (~$cas_queue_waiting_to_start_cancelled$ = %i(1))			:i $scriptassert$${StructString 0x00000000 = "This should never be set here"}$		:i endif		:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})		:i if NOT $StructureContains$$structure$ = %GLOBAL%$player_info$$requested_frame$			:i $cas_stop_loading_anim$$player_index$ = %GLOBAL%$index$		:i endif		:i if (~$testing_strings$ = $true$)			:i if (%GLOBAL%$new_instrument$ = $guitar$ OR %GLOBAL%$new_instrument$ = $guitar_and_vocals$)				:i $set_guitar_string_properties$$appearance$ = %GLOBAL%$new_appearance$$info_struct$ = $musician1_info$$name$ = $musician1$			:i elseif (%GLOBAL%$new_instrument$ = $Bass$ OR %GLOBAL%$new_instrument$ = $bass_and_vocals$)				:i $set_bass_string_properties$$appearance$ = %GLOBAL%$new_appearance$$info_struct$ = $musician1_info$$name$ = $musician1$			:i endif			:i $BandManager_CreateStrings$${StructQBKey name = musician1}$		:i endif		:i $change$${			StructStruct cas_queue_current_job			{				StructHeader {}			}		}$				:i $change$${StructInt cas_queue_lock = 0}$		:i $spawnscriptnow$$cas_queue_update$$params$ = :s{$persistent_band$ = %GLOBAL%$persistent_band$:s}	:i endif	:i $change$${StructInt cas_queue_lock = 0}$	:i $OnExitRun$${StructQBKey NullScript}$	:i endfunction]Script cas_queue_update_death fce14cd4 [	:i $scriptassert$${StructString 0x00000000 = "cas_queue_update_death - My death is a sorry thing indeed"}$	:i endfunction]Script cas_queue_get_next_entry 0x4280adf3 [	:i $GetArraySize$${StructQBString cas_queue_player_info}$	:i $i$ = %i(0)	:i while 	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$i$:a})	:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$requested_frame$		:i $frame$ = (%GLOBAL%$player_info$->$requested_frame$)		:i if NOT $GotParam$${StructQBKey earliest_frame}$			:i $earliest_frame$ = %GLOBAL%$frame$		:i endif		:i if (%GLOBAL%$frame$ <= %GLOBAL%$earliest_frame$)			:i $earliest_frame$ = %GLOBAL%$frame$			:i $earliest_frame_index$ = %GLOBAL%$i$		:i endif	:i endif	:i $i$ = (%GLOBAL%$i$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i if $GotParam$${StructQBKey earliest_frame_index}$		:i return $true$$index$ = %GLOBAL%$earliest_frame_index$	:i endif	:i endfunction]Script cas_queue_prepare_new_object 0x11cf3d2f [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				player_info				index			]		}		StructQBKey all	}$		:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$object$		:i $old_object$ = (%GLOBAL%$player_info$->$object$)	:i endif	:i if (%GLOBAL%$player_info$->$fast_cas_update$ = %i(1))		:i if NOT $CompositeObjectExists$$name$ = %GLOBAL%$old_object$			:i $scriptassert$%s("Cannot fast update on %d")$d$ = %GLOBAL%$old_object$		:i endif		:i $new_object$ = %GLOBAL%$old_object$		:i $RemoveParameter$${StructQBKey old_object}$	:i else 		:i if NOT $GotParam$${StructQBKey old_object}$			:i $FormatText$$checksumname$ = $new_object$%s("musician%i")$i$ = (%GLOBAL%$index$ + %i(1))		:i else 			:i $cas_queue_internal_destroy_object$$object$ = %GLOBAL%$old_object$			:i $new_object$ = %GLOBAL%$old_object$			:i $RemoveParameter$${StructQBKey old_object}$		:i endif		:i if $CompositeObjectExists$$name$ = %GLOBAL%$new_object$			:i $scriptassert$${StructString 0x00000000 = "Some logic issue here, this object should not exist"}$		:i endif	:i endif	:i return $old_object$ = %GLOBAL%$old_object$$new_object$ = %GLOBAL%$new_object$	:i endfunction]Script cas_queue_start_job 0x20471a2e [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				index				new_object			]		}	}$		:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})	:i $get_body_checksum_from_appearance$$appearance$ = (%GLOBAL%$player_info$->$pending_appearance$)	:i $is_female$ = (%GLOBAL%$player_info$->$pending_is_female$)	:i $change$$cas_queue_current_job$ = :s{		:i $new_object$ = %GLOBAL%$new_object$		:i $old_object$ = %GLOBAL%$old_object$		:i $current_player_index$ = %GLOBAL%$index$		:i $appearance_checksum$ = (%GLOBAL%$player_info$->$appearance_checksum$)		:i $body_checksum$ = %GLOBAL%$body_checksum$		:i $is_female$ = %GLOBAL%$is_female$	:i :s}	:i $cas_queue_remove_job_details$$player_info$ = %GLOBAL%$player_info$$index$ = %GLOBAL%$index$$startedjob$	:i endfunction]Script cas_queue_remove_job_details c2379d5d [	:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = pending_appearance	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = pending_instrument	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = pending_is_female	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = requested_frame	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = fast_cas_update	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = hide_old_character	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = character_id	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = savegame	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = appearance_checksum	}$		:i $RemoveComponent$${		StructQBKey structure_name = player_info		StructQBKey name = has_mic	}$		:i $SetArrayElement$$arrayName$ = $cas_queue_player_info$$globalarray$$index$ = %GLOBAL%$index$$newValue$ = %GLOBAL%$player_info$	:i if NOT $GotParam$${StructQBKey startedjob}$		:i $cas_stop_loading_anim$$player_index$ = %GLOBAL%$index$	:i endif	:i endfunction]Script cas_queue_build_new_character aaafeace [	${StructQBKey Instrument = None}$	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})	:i if $GotParam$${StructQBKey hide_old_character}$		:i if $GotParam$${StructQBKey old_object}$			:i if $CompositeObjectExists$$name$ = %GLOBAL%$old_object$				:i $cas_queue_internal_destroy_object$$object$ = %GLOBAL%$old_object$			:i endif		:i endif	:i endif	:i if $create_band_member$:s{			:i $profile_struct$ = %GLOBAL%$profile$			:i $name$ = %GLOBAL%$new_object$			:i $async$ = %i(1)			:i $Pos$ = (%GLOBAL%$player_info$->$Pos$)			:i $dir$ = (%GLOBAL%$player_info$->$dir$)			:i $Instrument$ = %GLOBAL%$Instrument$			:i $appearance_checksum$ = %GLOBAL%$appearance_checksum$			:i $player$ = (%GLOBAL%$player_info$->$player$)			:i $id$ = %GLOBAL%$character_id$			:i $savegame$ = %GLOBAL%$savegame$			:i $with_mic$ = %GLOBAL%$has_mic$			:i $stored_character_index$ = (%GLOBAL%$player_info$->$stored_character_index$)		:i :s}		:i if (~$is_in_cas$ = %i(0))			:i $persistent_band_move_and_orient_band_member$$name$ = %GLOBAL%$new_object$		:i endif		:i $stars$		:i $printf$%s("Loaded new musician for %d")$d$ = (%GLOBAL%$index$)		:i $stars$		:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})		:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$Pos$			:i %GLOBAL%$new_object$.$obj_setposition$$position$ = (%GLOBAL%$player_info$->$Pos$)		:i endif		:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$dir$			:i %GLOBAL%$new_object$.$obj_setorientation$$dir$ = (%GLOBAL%$player_info$->$dir$)		:i endif		:i $player_info$ = :s{			:i %GLOBAL%$player_info$			:i $object$ = %GLOBAL%$new_object$		:i :s}		:i $SetArrayElement$$arrayName$ = $cas_queue_player_info$$globalarray$$index$ = %GLOBAL%$index$$newValue$ = %GLOBAL%$player_info$		:i if $GotParam$${StructQBKey old_object}$			:i if $CompositeObjectExists$$name$ = %GLOBAL%$old_object$				:i $cas_queue_internal_destroy_object$$object$ = %GLOBAL%$old_object$			:i endif		:i endif		:i $FormatText$$checksumname$ = $aliasname$%s("cas_player%d")$d$ = (%GLOBAL%$index$ + %i(1))		:i $AssignAlias$$id$ = %GLOBAL%$new_object$$alias$ = %GLOBAL%$aliasname$	:i else 		:i $stars$		:i $printf$%s("Cancelled new musician for %d")$d$ = (%GLOBAL%$index$)		:i $stars$		:i if $CompositeObjectExists$$name$ = %GLOBAL%$new_object$			:i $cas_queue_internal_destroy_object$$object$ = %GLOBAL%$new_object$		:i endif	:i endif	:i endfunction]Script cas_queue_new_character_profile 0x4c8dc444 [	${Unknown [0001260040c698af69696969000000180001240067e6859a6969696900000028000124001b0509c56969696900000000]}$	:i $printstruct$ isNull 	:i $CharacterProfileGetStruct$$name$ = %GLOBAL%$id$$savegame$ = %GLOBAL%$savegame$	:i $cas_queue_add_request$:s{		:i $appearance$ = (%GLOBAL%$profile_struct$->$appearance$)		:i $player$ = %GLOBAL%$player$		:i $force_update$ = %GLOBAL%$force_update$		:i $hide_old_character$ = %GLOBAL%$hide_old_character$		:i $Instrument$ = %GLOBAL%$Instrument$		:i $character_id$ = %GLOBAL%$id$		:i $savegame$ = %GLOBAL%$savegame$		:i $player$ = %GLOBAL%$player$	:i :s}	:i endfunction]Script cas_queue_internal_destroy_object f3ad4583 [	:i $destroy_band_member$$name$ = %GLOBAL%$object$	:i $GetArraySize$${StructQBString cas_queue_player_info}$	:i $i$ = %i(0)	:i while 	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$i$:a})	:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$object$		:i if ((%GLOBAL%$player_info$->$object$) = %GLOBAL%$object$)			:i $RemoveComponent$${				StructQBKey structure_name = player_info				StructQBKey name = object			}$						:i if $GotParam$${StructQBKey kill_pending_jobs}$				:i $cas_queue_remove_job_details$$player_info$ = %GLOBAL%$player_info$$index$ = %GLOBAL%$i$			:i else 				:i $SetArrayElement$$arrayName$ = $cas_queue_player_info$$globalarray$$index$ = %GLOBAL%$i$$newValue$ = %GLOBAL%$player_info$			:i endif		:i endif	:i endif	:i $i$ = (%GLOBAL%$i$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i endfunction]Script cas_queue_is_busy bc7fee2d [	:i if $StructureContains$${			StructQBString structure = cas_queue_current_job			StructQBKey new_object		}$				:i return $true$$busy_player$ = (~$cas_queue_current_job$->$current_player_index$)	:i endif	:i if $GotParam$${StructQBKey in_queue_too}$		:i if $cas_queue_get_next_entry$			:i return ${StructQBKey true}$		:i endif	:i endif	:i return ${StructQBKey false}$	:i endfunction]Script cas_queue_wait a82fbdf8 [	:i while 	:i if NOT $cas_queue_is_busy$$in_queue_too$ isNull 		:i continue	:i endif	:i $wait$${		StructInt 1		StructQBKey gameframe	}$		:i loop_to 	:i endfunction]Script cas_destroy_all_characters 0x63f4901b [	:i $printscriptinfo$${StructString 0x00000000 = "cas_destroy_all_characters"}$	:i $cas_queue_kill_player$${StructInt player = 1}$	:i $cas_queue_kill_player$${StructInt player = 2}$	:i $cas_queue_kill_player$${StructInt player = 3}$	:i $cas_queue_kill_player$${StructInt player = 4}$	:i endfunction]Script cas_player_has_character_object 0x8bbf9c1b [	:i if ((%GLOBAL%$player$ < %i(1)) OR (%GLOBAL%$player$ > %i(4)))		:i return ${StructQBKey false}$	:i endif	:i $index$ = (%GLOBAL%$player$ - %i(1))	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})	:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$object$		:i if $CompositeObjectExists$$name$ = (%GLOBAL%$player_info$->$object$)			:i return $true$$character_object$ = (%GLOBAL%$player_info$->$object$)		:i endif	:i endif	:i return ${StructQBKey false}$	:i endfunction]Script cas_get_is_female 0x1fc5c700 [	:i if ((%GLOBAL%$player$ < %i(1)) OR (%GLOBAL%$player$ > %i(4)))		:i $scriptassert$${StructString 0x00000000 = "player must be 1-4"}$	:i endif	:i $index$ = (%GLOBAL%$player$ - %i(1))	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})	:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$pending_is_female$		:i $printf$${StructString 0x00000000 = "Pending gender queried"}$		:i return $is_female$ = (%GLOBAL%$player_info$->$pending_is_female$)	:i endif	:i if $cas_queue_is_busy$		:i if ((~$cas_queue_current_job$->$current_player_index$) = %GLOBAL%$index$)			:i $printf$${StructString 0x00000000 = "In process gender queried"}$			:i return $is_female$ = (~$cas_queue_current_job$->$is_female$)		:i endif	:i endif	:i if NOT $StructureContains$$structure$ = %GLOBAL%$player_info$$object$		:i $printstruct$%GLOBAL%$player_info$		:i $printstruct$(~$cas_queue_current_job$)		:i $printf$${StructString 0x00000000 = "player has no current object"}$		:i return ${StructInt is_female = 0}$	:i endif	:i $old_object$ = (%GLOBAL%$player_info$->$object$)	:i if NOT $CompositeObjectExists$$name$ = %GLOBAL%$old_object$		:i $scriptassert$${StructString 0x00000000 = "Player object doesnt exist"}$	:i endif	:i if NOT %GLOBAL%$old_object$.$getsingletag$$is_female$		:i $scriptassert$${StructString 0x00000000 = "is_female missing from object"}$	:i endif	:i $printf$${StructString 0x00000000 = "Object gender queried"}$	:i return $is_female$ = %GLOBAL%$is_female$	:i endfunction]Script cas_queue_fast_update 0x2292caae [	$Instrument$ = (~$cas_current_instrument$)$async$ = %i(1)	:i $CASWaitForComposite$	:i $CASTemporariesFlush$	:i %GLOBAL%$cas_object$.$obj_spawnscriptnow$$BuildCASModel$$params$ = :s{		:i $async$ = %GLOBAL%$async$		:i $appearance$ = %GLOBAL%$appearance$		:i $buildscript$ = $modelbuilder_build_model$		:i $buildscriptparams$ = :s{			:i %GLOBAL%$buildscriptparams$			:i $Instrument$ = %GLOBAL%$Instrument$		:i :s}		:i $appearance_checksum$ = %GLOBAL%$appearance_checksum$		:i $use_cache$ = %i(1)	:i :s}	:i if (%GLOBAL%$async$ = %i(1))		:i $BlockForScript$${StructQBKey BuildCASModel}$	:i endif	:i if (~$g_cas_model_build_success$ = %i(1))		:i $fix_animation_struct_for_avatar$$object$ = %GLOBAL%$cas_object$$Instrument$ = %GLOBAL%$Instrument$		:i return ${StructQBKey true}$	:i else 		:i return ${StructQBKey false}$	:i endif	:i endfunction]Script cas_set_object_node_pos 0x323065aa [	${StructQBKey Instrument = None}$	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				player			]		}		StructQBKey all	}$		:i $index$ = (%GLOBAL%$player$ - %i(1))	:i if $GotParam$${StructQBKey node}$		:i $GetWaypointPos$$name$ = %GLOBAL%$node$		:i $GetWaypointQuat$$name$ = %GLOBAL%$node$	:i else 		:i if $GetInstrumentNodeName$$Instrument$ = %GLOBAL%$Instrument$			:i $GetWaypointPos$$name$ = %GLOBAL%$instrument_node_name$			:i $GetWaypointQuat$$name$ = %GLOBAL%$instrument_node_name$		:i else 			:i $GetWaypointPos$${StructQBString name = CAS_node_name}$			:i $GetWaypointQuat$${StructQBString name = CAS_node_name}$		:i endif	:i endif	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$index$:a})	:i $player_info$ = :s{		:i %GLOBAL%$player_info$		:i $Pos$ = %GLOBAL%$Pos$		:i $dir$ = %GLOBAL%$dir$	:i :s}	:i $SetArrayElement$$arrayName$ = $cas_queue_player_info$$globalarray$$index$ = %GLOBAL%$index$$newValue$ = %GLOBAL%$player_info$	:i if $cas_player_has_character_object$$player$ = %GLOBAL%$player$		:i $newpos$ = %GLOBAL%$Pos$		:i %GLOBAL%$character_object$.$obj_getposition$		:i %GLOBAL%$character_object$.$obj_setposition$$position$ = %GLOBAL%$newpos$		:i if NOT (%GLOBAL%$Pos$ = %GLOBAL%$newpos$)			:i %GLOBAL%$character_object$.$obj_setorientation$$Quat$ = %GLOBAL%$Quat$		:i endif	:i endif	:i endfunction]Script cas_queue_block e539f136 [	:i while 	:i if NOT $cas_queue_is_busy$$in_queue_too$ isNull 		:i return 	:i endif	:i $CasBlockForLoading$	:i $CasBlockForComposite$	:i $wait$${		StructInt 1		StructQBKey gameframe	}$		:i loop_to 	:i endfunction]Script cas_get_loading_id ab237859 [	:i $FormatText$$checksumname$ = $id$%s("cas_loading_clock_%d")$d$ = %GLOBAL%$player_index$$addtostringlookup$ = $true$	:i return $id$ = %GLOBAL%$id$	:i endfunction]Script cas_start_loading_anim 0x34acec50 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				player_index			]		}		StructQBKey all	}$		:i $cas_get_loading_id$$player_index$ = %GLOBAL%$player_index$	:i $get_cas_loading_pos$$player_index$ = %GLOBAL%$player_index$	:i if $cas_loading_needs_recreation$$player_index$ = %GLOBAL%$player_index$		:i if $ScreenElementExists$$id$ = %GLOBAL%$id$			:i %GLOBAL%$id$.$Die$		:i endif	:i endif	:i if $ScreenElementExists$$id$ = %GLOBAL%$id$		:i %GLOBAL%$id$.$obj_killspawnedscript$$name$ = $kill_watch_timer$		:i %GLOBAL%$id$.$removetags$:a{$dying$:a}		:i %GLOBAL%$id$.$se_setprops$$Pos$ = %GLOBAL%$Pos$		:i %GLOBAL%$id$.$obj_spawnscriptnow$$watch_animate_in$$params$ = :s{$time$ = %f(0.2000000):s}	:i else 		:i if (~$cas_loading_setup$ = $lobby$)			:i if $band_lobby_get_watch_timer_parent$$cas_player_index$ = %GLOBAL%$player_index$				:i $make_watch_timer$$parent$ = %GLOBAL%$parent$$id$ = %GLOBAL%$id$$Pos$ = %GLOBAL%$Pos$			:i else 				:i $printf$%s("No lobby created yet %a")$a$ = %GLOBAL%$player_index$				:i $make_watch_timer$$id$ = %GLOBAL%$id$$Pos$ = %GLOBAL%$Pos$			:i endif		:i else 			:i $make_watch_timer$$id$ = %GLOBAL%$id$$Pos$ = %GLOBAL%$Pos$		:i endif	:i endif	:i endfunction]Script cas_loading_needs_recreation 0x4daec3ae [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				player_index			]		}		StructQBKey all	}$		:i $cas_get_loading_id$$player_index$ = %GLOBAL%$player_index$	:i if $ScreenElementExists$$id$ = %GLOBAL%$id$		:i %GLOBAL%$id$.$se_getparentid$		:i $current_parent_id$ = %GLOBAL%$parent_id$	:i else 		:i $current_parent_id$ = $None$	:i endif	:i if (~$cas_loading_setup$ = $lobby$)		:i if $band_lobby_get_watch_timer_parent$$cas_player_index$ = %GLOBAL%$player_index$			:i $desired_parent_id$ = %GLOBAL%$parent$		:i else 			:i return ${StructQBKey false}$		:i endif	:i else 		:i $desired_parent_id$ = $root_window$	:i endif	:i if (%GLOBAL%$desired_parent_id$ !== %GLOBAL%$current_parent_id$)		:i return ${StructQBKey true}$	:i else 		:i return ${StructQBKey false}$	:i endif	:i endfunction]Script cas_stop_loading_anim 0x122970f6 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				player_index			]		}		StructQBKey all	}$		:i $cas_get_loading_id$$player_index$ = %GLOBAL%$player_index$	:i if $ScreenElementExists$$id$ = %GLOBAL%$id$		:i %GLOBAL%$id$.$obj_spawnscriptnow$$kill_watch_timer$	:i endif	:i endfunction]Script kill_watch_timer 0x85bdbaf3 [	:i $settags$${StructInt dying = 1}$	:i $setscriptcannotpause$	:i if ((~$cas_loading_setup$) !== $hidden$)		:i $watch_animate_out$${StructFloat time = 0.20000000298023224}$		:i $wait$${			StructFloat 0.20000000298023224			StructQBKey seconds		}$			:i endif	:i $Die$	:i endfunction]Script get_cas_loading_pos 0x07034382 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				player_index			]		}		StructQBKey all	}$		:i if (%GLOBAL%$player_index$ > %i(3))		:i $scriptassert$%s("out of range %i")$i$ = %GLOBAL%$player_index$	:i endif	:i switch (~$cas_loading_setup$)		:i case $lobby$			:i if NOT $band_lobby_get_watch_timer_parent$$cas_player_index$ = %GLOBAL%$player_index$				:i return ${					StructFloatX2 Pos					{						Floats [2000.00, -375.000]					}				}$							:i endif			:i return ${				StructFloatX2 Pos				{					Floats [50.0000, -50.0000]				}			}$						:i endcase		case $single$			:i return ${				StructFloatX2 Pos				{					Floats [760.000, 0.00000]				}			}$						:i endcase		case $hidden$			:i return ${				StructFloatX2 Pos				{					Floats [2000.00, -375.000]				}			}$						:i endcase		default 			:i $scriptassert$%s("unknown %s")$s$ = (~$cas_loading_setup$)	:i end_switch	:i $scriptassert$%s("%s %d")$s$ = (~$cas_loading_setup$)$d$ = %GLOBAL%$player_index$	:i endfunction]Script set_cas_loading_setup b80b2280 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				setup			]		}		StructQBKey all	}$		:i $change$$cas_loading_setup$ = %GLOBAL%$setup$	:i $i$ = %i(0)	:i while 	:i $cas_get_loading_id$$player_index$ = %GLOBAL%$i$	:i if $ScreenElementExists$$id$ = %GLOBAL%$id$		:i if $cas_loading_needs_recreation$$player_index$ = %GLOBAL%$i$			:i if %GLOBAL%$id$.$getsingletag$$dying$				:i %GLOBAL%$id$.$Die$			:i else 				:i %GLOBAL%$id$.$Die$				:i $cas_start_loading_anim$$player_index$ = %GLOBAL%$i$			:i endif		:i else 			:i $get_cas_loading_pos$$player_index$ = %GLOBAL%$i$			:i %GLOBAL%$id$.$se_setprops$$Pos$ = %GLOBAL%$Pos$		:i endif	:i endif	:i $i$ = (%GLOBAL%$i$ + %i(1))	:i loop_to %i(4)	:i endfunction]Script cas_queue_external_destroy_object 0x1cf77ec1 [	:i $RequireParams$${		StructArray 0x00000000		{			ArrayQBKey			[				name			]		}		StructQBKey all	}$		:i $GetArraySize$${StructQBString cas_queue_player_info}$	:i $i$ = %i(0)	:i while 	:i $player_info$ = (~$cas_queue_player_info$:a{%GLOBAL%$i$:a})	:i if $StructureContains$$structure$ = %GLOBAL%$player_info$$object$		:i if (%GLOBAL%$name$ = (%GLOBAL%$player_info$->$object$))			:i $RemoveComponent$${				StructQBKey structure_name = player_info				StructQBKey name = object			}$						:i $SetArrayElement$$arrayName$ = $cas_queue_player_info$$globalarray$$index$ = %GLOBAL%$i$$newValue$ = %GLOBAL%$player_info$			:i return 		:i endif	:i endif	:i $i$ = (%GLOBAL%$i$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i endfunction]Script cas_queue_cancel_loading 0x8d227b66 [	:i if $StructureContains$$structure$ = (~$cas_queue_current_job$)$appearance_checksum$		:i $change$$cas_queue_current_job$ = :s{			:i (~$cas_queue_current_job$)			:i $appearance_checksum$ = $Cancelled$		:i :s}	:i endif	:i if (~$cas_queue_waiting_to_start$ = %i(1))		:i $change$${StructInt cas_queue_waiting_to_start_cancelled = 1}$	:i endif	:i endfunction]Script set_all_character_viewports_on 0x6bc2a98a [	:i $GetArraySize$${StructQBString cas_object_name_list}$	:i $i$ = %i(0)	:i while 	:i $new_object$ = ((~$cas_object_name_list$):a{%GLOBAL%$i$:a})	:i if $CompositeObjectExists$$name$ = %GLOBAL%$new_object$		:i $printf$%s("Setting visibility on %s for all viewports")$s$ = %GLOBAL%$new_object$		:i $character_hide_particle_systems$$object_name$ = %GLOBAL%$new_object$		:i %GLOBAL%$new_object$.$obj_setvisibility$$all$		:i $character_unhide_particle_systems$$object_name$ = %GLOBAL%$new_object$	:i endif	:i $i$ = (%GLOBAL%$i$ + %i(1))	:i loop_to %GLOBAL%$array_size$	:i endfunction]